# Error Protocol Specification (EPS)

## Purpose

EPS defines how errors are reported, formatted, routed, and remediated within the RUNE framework. This protocol ensures that all failure modes—whether from remote plugins, internal modules, or transport failures—return a predictable, machine-parseable structure.

## Scope

EPS messages are generated by any RUNE component encountering an error (plugin, LMM, transport, etc.) and routed through the Mediator for centralized handling and logging.

---

## Error Message Structure

```json
{
  "routing": {
    "event_type": "EPS_ERROR_RESPONSE",
    "source_module": "mediator",
    "target_module": "error_handler"
  },
  "error_payload": {
    "error_data": {
      "code": -32001,
      "message": "Plugin execution failed",
      "data": {
        "plugin": "restart-docker",
        "host": "web-01",
        "reason": "Non-zero exit code",
        "exit_code": 1
      }
    },
    "error_context": {
      "severity": "medium",
      "recoverable": true,
      "recovery_actions": ["retry", "alert-operator"]
    }
  }
}
```

---

## Field Descriptions

- `event_type`: Always set to `EPS_ERROR_RESPONSE`
- `source_module`: Origin of the error (e.g., `mediator`, `transport`, `plugin`)
- `target_module`: Optional; default is centralized error handler
- `error_data.code`: Integer code (negative)
- `error_data.message`: Human-readable summary
- `error_data.data`: Arbitrary structured context
- `error_context.severity`: `low`, `medium`, `high`, or `critical`
- `error_context.recoverable`: Boolean
- `error_context.recovery_actions`: Suggested actions (`retry`, `fallback`, `alert`, etc.)

---

## Error Generation Rules

- Any plugin that exits non-zero **must** emit a structured EPS error (if it can)
- The mediator will wrap stdout/stderr failures in EPS automatically
- All transport or execution errors must be normalized to EPS

---

## Notes

- EPS is for machine handling, not end-user output (LMM/LOM can format it)
- Log output from errors should be associated via `message_id` or `trace_id`
- EPS is routed like RCS messages, but always interpreted as an exception path

© 2025 Richard Majewski. Licensed under the MPL-2.0.
