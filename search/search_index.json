{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"RUNE","text":"<p>RUNE is a remediation execution framework for corporate IT operations. It runs curated recovery actions (plugins) on remote Linux hosts and returns structured, machine readable results.</p> <p>RUNE is a personal platform project that captures how I think about reliability, mediation, and operational clarity in real-world systems.</p> <p>RUNE is intentionally not a configuration management system. It does not manage desired state. It executes targeted actions to recover services, validate system health, and automate runbooks with audit friendly output.</p>"},{"location":"#what-rune-is-for","title":"What RUNE is for","text":"<ul> <li>Incident response and service recovery: restart services, fix broken dependencies, validate a repair</li> <li>Fleet hygiene checks: run standardized diagnostics and return structured results</li> <li>Security and compliance runbooks: verify settings, collect evidence, remediate a narrowly scoped issue</li> <li>Operations automation where you need traceable, deterministic execution rather than ad hoc SSH sessions</li> </ul>"},{"location":"#what-rune-is-not","title":"What RUNE is not","text":"<ul> <li>Not Ansible, Salt, Puppet, Chef, or a general state enforcement tool</li> <li>Not a remote shell wrapper that streams unstructured console output</li> <li>Not a patch management system</li> </ul>"},{"location":"#how-it-works","title":"How it works","text":"<ol> <li>An operator or automation trigger requests an action.</li> <li>The Lifecycle Orchestration Module (LOM) validates intent and selects an execution plan.</li> <li>The Local Mediation Module (LMM) routes and executes the action via a transport (SSH or SSM).</li> <li>A plugin runs on the target node and communicates via a strict JSON protocol.</li> <li>Results and errors are returned in stable envelopes suitable for automation, logging, and audit.</li> </ol> <p>RUNE is protocol first. The protocols are the product contract:</p> <ul> <li>Runtime Communication Specification (RCS): internal runtime messages</li> <li>Module Registration Specification (MRS): capability and module registration</li> <li>Bash Plugin Communication Specification (BPCS): plugin stdin and stdout contract</li> <li>Error Protocol Specification (EPS): standardized errors</li> </ul>"},{"location":"#start-here","title":"Start here","text":"<ul> <li>Why RUNE</li> <li>Quick Start</li> <li>Install</li> <li>Architecture</li> <li>Plugin Developer Guide</li> <li>Protocols</li> </ul>"},{"location":"#project-status","title":"Project status","text":"<p>RUNE is designed as a production grade architecture with a minimal initial implementation. Some features are implemented as profiles or static configuration in early builds, while keeping the same protocol contracts so behavior can scale without breaking integrations.</p>"},{"location":"Design_Principles/","title":"Design principles","text":"<p>RUNE is designed for corporate IT operations where safety, auditability, and predictable execution matter more than cleverness.</p>"},{"location":"Design_Principles/#principles","title":"Principles","text":""},{"location":"Design_Principles/#protocol-first-contracts","title":"Protocol first contracts","text":"<p>RUNE uses explicit protocol specifications as the product contract:</p> <ul> <li>RCS for runtime messages</li> <li>MRS for registration and capability discovery</li> <li>BPCS for plugin input and output</li> <li>EPS for error reporting</li> </ul> <p>This enables stable integration points even as implementation details evolve.</p>"},{"location":"Design_Principles/#mediation-as-the-safety-boundary","title":"Mediation as the safety boundary","text":"<p>All execution is mediated by the LMM. Plugins do not:</p> <ul> <li>choose transports</li> <li>call other modules directly</li> <li>decide how errors propagate</li> <li>invent their own output formats</li> </ul> <p>This concentrates risk control in one place.</p>"},{"location":"Design_Principles/#plugins-are-capabilities","title":"Plugins are capabilities","text":"<p>RUNE is intentionally small. The platform is the runtime and safety boundary. Capabilities live in plugins owned by teams that understand the services they operate.</p>"},{"location":"Design_Principles/#deterministic-machine-readable-output","title":"Deterministic, machine readable output","text":"<p>RUNE treats free form output as a liability. Plugins emit one JSON object with clear success or error semantics, suitable for:</p> <ul> <li>automation and policy checks</li> <li>searchable logs</li> <li>incident timelines</li> </ul>"},{"location":"Design_Principles/#observable-by-default","title":"Observable by default","text":"<p>Every request carries identifiers that support correlation across systems:</p> <ul> <li>message id and correlation id for request response linkage</li> <li>trace id and span id for distributed tracing</li> </ul>"},{"location":"Design_Principles/#safe-defaults","title":"Safe defaults","text":"<p>The LMM enforces guardrails:</p> <ul> <li>timeouts and retry policy</li> <li>output validation</li> <li>explicit transport configuration</li> <li>explicit plugin paths</li> </ul>"},{"location":"Design_Principles/#corporate-friendly-operational-model","title":"Corporate friendly operational model","text":"<p>RUNE favors patterns that fit common enterprise constraints:</p> <ul> <li>works with SSH and SSM</li> <li>does not require long running agents on targets</li> <li>supports controlled plugin distribution and change management</li> <li>produces outputs that can be ingested by SIEM and log pipelines</li> </ul>"},{"location":"Design_Principles/#see-also","title":"See also","text":"<ul> <li>Architecture</li> <li>Mediation model</li> </ul>"},{"location":"RUNE_Complete_Refernce/","title":"Documentation map","text":"<p>This page is the navigation and reading guide for RUNE. It is intentionally light on repeated explanations so the documentation stays consistent over time.</p>"},{"location":"RUNE_Complete_Refernce/#recommended-reading-paths","title":"Recommended reading paths","text":""},{"location":"RUNE_Complete_Refernce/#if-you-want-the-2-minute-overview","title":"If you want the 2 minute overview","text":"<ol> <li>Why RUNE</li> <li>Architecture</li> <li>Quick start</li> </ol>"},{"location":"RUNE_Complete_Refernce/#if-you-want-to-understand-how-execution-is-controlled","title":"If you want to understand how execution is controlled","text":"<ol> <li>Mediation model</li> <li>Action lifecycle</li> <li>Security model</li> </ol>"},{"location":"RUNE_Complete_Refernce/#if-you-want-to-understand-the-protocol-contracts","title":"If you want to understand the protocol contracts","text":"<ul> <li>Runtime Communication Specification (RCS)</li> <li>Module Registration Specification (MRS)</li> <li>Bash Plugin Communication Specification (BPCS)</li> <li>Error Protocol Specification (EPS)</li> <li>JSON appendix</li> </ul>"},{"location":"RUNE_Complete_Refernce/#if-you-want-to-build-plugins","title":"If you want to build plugins","text":"<ol> <li>Plugin development guide</li> <li>Bash library reference</li> <li>Testing guide</li> </ol>"},{"location":"RUNE_Complete_Refernce/#what-each-section-is-for","title":"What each section is for","text":""},{"location":"RUNE_Complete_Refernce/#concepts","title":"Concepts","text":"<p>The high level model of how RUNE works, what problems it is designed to solve, and what the safety boundaries are.</p> <ul> <li>Architecture</li> <li>Mediation model</li> <li>Action lifecycle</li> <li>Design principles</li> <li>Glossary</li> </ul>"},{"location":"RUNE_Complete_Refernce/#protocols","title":"Protocols","text":"<p>The formal contracts between components, and between the framework and plugins.</p> <ul> <li>RCS</li> <li>MRS</li> <li>BPCS</li> <li>EPS</li> </ul>"},{"location":"RUNE_Complete_Refernce/#development","title":"Development","text":"<p>Everything required to extend, test, and maintain RUNE.</p> <ul> <li>Plugin development guide</li> <li>Bash library reference</li> <li>Testing guide</li> <li>Style guide</li> <li>API reference</li> </ul>"},{"location":"RUNE_Complete_Refernce/#reference","title":"Reference","text":"<p>Large examples and schema consolidated for copy and paste.</p> <ul> <li>JSON appendix</li> </ul>"},{"location":"RUNE_Complete_Refernce/#if-you-are-evaluating-rune-for-corporate-operations","title":"If you are evaluating RUNE for corporate operations","text":"<p>Start with:</p> <ul> <li>Why RUNE</li> <li>Architecture</li> <li>Security model</li> </ul> <p>Then skim the protocol pages and the JSON appendix as needed.</p>"},{"location":"STYLE_GUIDE/","title":"Style guide","text":"<p>This guide defines coding and documentation conventions for RUNE. It is written for Python 3.13+ development with modern tooling and a bias toward correctness, maintainability, and operational safety.</p>"},{"location":"STYLE_GUIDE/#language-baseline","title":"Language baseline","text":"<ul> <li>Minimum Python: 3.13</li> <li>Supported Python: the project should remain compatible with the latest stable CPython release where practical.</li> <li>Typing: all new code should be type annotated. Prefer types that are enforced by tooling (not comments).</li> </ul>"},{"location":"STYLE_GUIDE/#formatting-and-linting","title":"Formatting and linting","text":""},{"location":"STYLE_GUIDE/#formatting","title":"Formatting","text":"<p>Use Ruff formatter as the single source of formatting truth.</p> <pre><code>ruff format .\n</code></pre>"},{"location":"STYLE_GUIDE/#linting","title":"Linting","text":"<p>Use Ruff for linting. Treat new lint warnings as failures in CI.</p> <pre><code>ruff check .\n</code></pre> <p>General expectations:</p> <ul> <li>No unused imports, variables, or unreachable code.</li> <li>No implicit optional (<code>Optional[...]</code>) ambiguity. Use <code>| None</code>.</li> <li>No bare <code>except:</code>. Catch the narrowest exception type possible.</li> <li>No <code>print()</code> in library code. Use logging. (CLI output is an exception.)</li> </ul>"},{"location":"STYLE_GUIDE/#type-checking","title":"Type checking","text":"<p>Use a static type checker (recommended: Pyright) in CI and locally.</p> <p>Principles:</p> <ul> <li>Prefer precise types over <code>Any</code>.</li> <li>Use <code>Protocol</code> and structural typing for interfaces where it improves testability.</li> <li>Use <code>TypedDict</code> for JSON-like payloads when a full model class is unnecessary.</li> <li>Use <code>TypeAlias</code> for repeated complex types.</li> </ul> <p>Examples:</p> <pre><code>from __future__ import annotations\n\nfrom typing import TypeAlias, TypedDict\n\nTraceId: TypeAlias = str\n\nclass RcsRouting(TypedDict):\n    event_type: str\n    target_module: str\n\ndef parse_trace_id(value: str) -&gt; TraceId:\n    return value\n</code></pre>"},{"location":"STYLE_GUIDE/#imports","title":"Imports","text":"<p>Follow these rules:</p> <ul> <li>Group imports: standard library, third-party, local.</li> <li>One import per line where it improves diff readability.</li> <li>Prefer <code>from collections.abc import Iterable, Mapping</code> over importing ABCs from <code>typing</code>.</li> <li>Prefer absolute imports inside the package unless relative imports improve clarity within a subpackage.</li> </ul> <p>Ruff can enforce ordering.</p>"},{"location":"STYLE_GUIDE/#naming-conventions","title":"Naming conventions","text":"<ul> <li>Modules: <code>snake_case.py</code></li> <li>Classes: <code>CapWords</code></li> <li>Functions and variables: <code>snake_case</code></li> <li>Constants: <code>UPPER_SNAKE_CASE</code></li> <li>Private internals: prefix with <code>_</code> to indicate non-public API.</li> </ul>"},{"location":"STYLE_GUIDE/#code-structure","title":"Code structure","text":""},{"location":"STYLE_GUIDE/#prefer-explicit-boundaries","title":"Prefer explicit boundaries","text":"<p>RUNE is protocol-first. Code should reflect this:</p> <ul> <li>Validate inputs at boundaries (CLI parsing, protocol parsing, plugin output parsing).</li> <li>Keep execution side effects contained and observable.</li> <li>Keep orchestration logic (decisions) separate from transport logic (how commands run).</li> </ul>"},{"location":"STYLE_GUIDE/#dataclasses-and-immutability","title":"Dataclasses and immutability","text":"<ul> <li>Use <code>@dataclass(slots=True)</code> for lightweight data containers.</li> <li>Prefer immutability for values passed between layers where it reduces accidental mutation.</li> </ul> <pre><code>from dataclasses import dataclass\n\n@dataclass(slots=True, frozen=True)\nclass ActionRequest:\n    action: str\n    node: str\n</code></pre>"},{"location":"STYLE_GUIDE/#paths-and-files","title":"Paths and files","text":"<ul> <li>Use <code>pathlib.Path</code> for filesystem operations.</li> <li>When writing files, write atomically where feasible (write to temp, then replace).</li> </ul>"},{"location":"STYLE_GUIDE/#errors-and-exceptions","title":"Errors and exceptions","text":"<ul> <li>Raise exceptions for programmer errors and invariant violations.</li> <li>For recoverable operational failures (remote host unreachable, plugin failure), convert to the project\u2019s structured error protocol at the boundary where the failure is reported.</li> <li>Never swallow exceptions silently.</li> <li>Do not use exceptions for normal control flow.</li> </ul> <p>Avoid overly broad patterns:</p> <pre><code># Avoid\ntry:\n    ...\nexcept Exception:\n    ...\n</code></pre> <p>Prefer narrow handling:</p> <pre><code>try:\n    ...\nexcept FileNotFoundError as e:\n    ...\n</code></pre>"},{"location":"STYLE_GUIDE/#logging-and-observability","title":"Logging and observability","text":"<ul> <li>Use the standard library <code>logging</code> module for all non-CLI output.</li> <li>Logs must be structured enough to support troubleshooting:</li> <li>include node, action, and trace id where available</li> <li>include exception context with <code>logger.exception(...)</code> when handling failures</li> <li>Never log secrets (tokens, private keys, full command lines containing credentials).</li> </ul>"},{"location":"STYLE_GUIDE/#subprocess-and-remote-execution-safety","title":"Subprocess and remote execution safety","text":"<p>If invoking local commands (including SSH/SSM wrappers):</p> <ul> <li>Prefer <code>subprocess.run([...], check=True, text=True, capture_output=True)</code> with a list of args.</li> <li>Avoid <code>shell=True</code> unless there is a documented and reviewed need.</li> <li>Set timeouts for network and long-running operations.</li> <li>Sanitize or validate any user-provided arguments before constructing commands.</li> </ul>"},{"location":"STYLE_GUIDE/#concurrency-and-async","title":"Concurrency and async","text":"<p>If using asyncio:</p> <ul> <li>Prefer <code>asyncio.TaskGroup</code> for structured concurrency.</li> <li>Ensure tasks are awaited or managed. Do not spawn orphan tasks.</li> <li>Use timeouts and cancellation handling for remote operations.</li> </ul>"},{"location":"STYLE_GUIDE/#documentation","title":"Documentation","text":""},{"location":"STYLE_GUIDE/#docstrings","title":"Docstrings","text":"<p>Use docstrings for public functions, public classes, and non-trivial internal functions.</p> <ul> <li>Follow PEP 257 conventions.</li> <li>Keep the first line as a single-sentence summary.</li> <li>Document side effects and failure modes.</li> </ul> <p>Example:</p> <pre><code>def run_action(action: str, node: str) -&gt; None:\n    \"\"\"Execute an action against a node.\n\n    Raises:\n        ValueError: If the action name is invalid.\n        RuntimeError: If execution fails after retries.\n    \"\"\"\n</code></pre>"},{"location":"STYLE_GUIDE/#markdown-docs","title":"Markdown docs","text":"<ul> <li>Prefer short sections with direct headings.</li> <li>Avoid duplicating protocol details across multiple pages. Link to canonical references.</li> <li>Use code fences for all examples; keep examples minimal and correct.</li> </ul>"},{"location":"STYLE_GUIDE/#testing","title":"Testing","text":"<p>Use pytest for unit and integration tests.</p> <p>Expectations:</p> <ul> <li>Tests should be deterministic and not depend on external infrastructure unless explicitly marked as integration tests.</li> <li>Prefer dependency injection and fakes over patch-heavy tests.</li> <li>Validate both success and failure paths for protocol parsing and plugin execution.</li> </ul> <p>Suggested commands:</p> <pre><code>pytest\npytest -q\n</code></pre>"},{"location":"STYLE_GUIDE/#tooling-and-automation","title":"Tooling and automation","text":"<p>Recommended baseline:</p> <ul> <li><code>ruff</code> for formatting and linting</li> <li><code>pyright</code> (or equivalent) for type checking</li> <li><code>pytest</code> for tests</li> <li><code>pre-commit</code> to enforce checks before commit</li> </ul> <p>Example pre-commit tools:</p> <pre><code>pre-commit install\npre-commit run --all-files\n</code></pre>"},{"location":"STYLE_GUIDE/#summary","title":"Summary","text":"<ul> <li>Format with Ruff.</li> <li>Lint with Ruff.</li> <li>Type check with Pyright.</li> <li>Test with pytest.</li> <li>Keep boundaries explicit, validate inputs early, and produce observable behavior.</li> </ul>"},{"location":"api_reference/","title":"API reference","text":"<p>This document describes the operator facing CLI surface and the protocol level contracts that make RUNE automation friendly.</p> <p>If you are looking for message formats, start with RCS, BPCS, and EPS.</p>"},{"location":"api_reference/#cli-surface","title":"CLI surface","text":""},{"location":"api_reference/#execute-an-action","title":"Execute an action","text":"<pre><code>rune run &lt;action&gt; --node &lt;hostname-or-node-id&gt; [--param key=value ...] [--json]\n</code></pre> <ul> <li><code>action</code>: registry name of the action to run</li> <li><code>--node</code>: target node identifier</li> <li><code>--param key=value</code>: repeatable key value parameters passed to the plugin input</li> <li><code>--json</code>: emit machine readable output</li> </ul>"},{"location":"api_reference/#output-shape","title":"Output shape","text":"<p>In JSON mode, the CLI emits a stable success or failure shape:</p> <ul> <li>Success: BPCS style payload with <code>error: null</code></li> <li>Failure: an EPS envelope (or an EPS shaped error object) depending on output mode</li> </ul> <p>The intent is that automation can reliably detect failures without parsing console text.</p>"},{"location":"api_reference/#exit-codes","title":"Exit codes","text":"<p>The CLI should follow standard conventions:</p> <ul> <li><code>0</code> success</li> <li>non zero failure</li> </ul> <p>Plugins may use more granular exit codes. The LMM interprets them using BPCS conventions.</p>"},{"location":"api_reference/#python-api-surface-library-mode","title":"Python API surface (library mode)","text":"<p>RUNE is designed so core components can be embedded in automation:</p> <ul> <li>LOM validates requests and consults registry</li> <li>LMM executes via transport and normalizes results</li> </ul> <p>Public Python APIs are intentionally small. The stable contracts are the protocols.</p>"},{"location":"api_reference/#protocol-level-api","title":"Protocol level API","text":"<p>The most stable interfaces in RUNE are message contracts.</p> <ul> <li>Runtime requests and responses use RCS envelopes.</li> <li>Capability registration uses MRS.</li> <li>Plugins use BPCS on stdin and stdout.</li> <li>Errors that must propagate are expressed as EPS.</li> </ul> <p>This makes the system suitable for integration with:</p> <ul> <li>ticketing workflows</li> <li>SOAR tooling</li> <li>chatops bots</li> <li>CI pipelines</li> <li>internal runbook automation</li> </ul>"},{"location":"architecture/","title":"Architecture","text":"<p>RUNE is built around clear separation of concerns and a strict mediation boundary. The framework executes plugins on remote Linux nodes while preserving auditability and predictable behavior.</p>"},{"location":"architecture/#components","title":"Components","text":""},{"location":"architecture/#cli","title":"CLI","text":"<p>Operator facing entry point. The CLI:</p> <ul> <li>collects action name, target node, and parameters</li> <li>generates identifiers (message id, correlation id, trace id)</li> <li>submits an execution request to the LOM</li> <li>prints a structured response</li> </ul>"},{"location":"architecture/#lifecycle-orchestration-module-lom","title":"Lifecycle Orchestration Module (LOM)","text":"<p>The LOM owns lifecycle and policy. It:</p> <ul> <li>validates operator intent and input shape</li> <li>consults the module and action registry (MRS)</li> <li>prepares the runtime request envelope (RCS)</li> <li>delegates execution to the LMM</li> </ul> <p>LOM is allowed to be in process for early builds. The contract is the protocol, not the process boundary.</p>"},{"location":"architecture/#local-mediation-module-lmm","title":"Local Mediation Module (LMM)","text":"<p>The LMM is the safety boundary. It:</p> <ul> <li>routes requests based on registry data (MRS)</li> <li>selects transport (SSH or SSM)</li> <li>enforces execution limits (timeouts, retry policy)</li> <li>invokes plugins using the plugin protocol (BPCS)</li> <li>validates plugin output</li> <li>normalizes errors into EPS and routes them to the ErrorHandler</li> </ul>"},{"location":"architecture/#transport-layer","title":"Transport layer","text":"<p>Transport implementations execute the plugin on the remote node.</p> <ul> <li>SSH transport: executes the plugin binary on the node and streams stdin and stdout</li> <li>SSM transport: executes via AWS Systems Manager where available and configured</li> </ul>"},{"location":"architecture/#plugin-execution-environment","title":"Plugin execution environment","text":"<p>The plugin is an executable on the target node. For Bash plugins, it should use the shared library that implements BPCS.</p>"},{"location":"architecture/#errorhandler","title":"ErrorHandler","text":"<p>A logical module that consumes EPS errors and produces:</p> <ul> <li>operator safe summaries</li> <li>structured logs for ingestion</li> <li>optional recovery recommendations</li> </ul> <p>In the reference implementation, this can be a core component within the same process.</p>"},{"location":"architecture/#system-view","title":"System view","text":"<p>This diagram shows the conceptual architecture of RUNE. Early builds may run multiple modules in a single process. The protocol contracts remain the same.</p> <pre><code>flowchart TD\n  EXT[Operator or automation trigger] --&gt; CLI[CLI]\n\n  CLI --&gt; LOM[LOM: Lifecycle Orchestration]\n  LOM --&gt; REG[Registry: MRS catalog]\n  LOM --&gt; LMM[LMM: Local Mediation]\n\n  LMM --&gt;|Select transport| TRANS{Transport}\n  TRANS --&gt;|SSH| SSH[SSH adapter]\n  TRANS --&gt;|SSM| SSM[AWS SSM adapter]\n\n  SSH --&gt; NODE[Target node]\n  SSM --&gt; NODE\n\n  NODE --&gt; PLUG[Plugin executable]\n  PLUG --&gt; LMM\n\n  LMM --&gt; ERR[ErrorHandler: EPS routing]\n  LMM --&gt; CLI\n\n  classDef core fill:#0b1020,stroke:#6b7280,color:#e5e7eb;\n  classDef edge fill:#111827,stroke:#6b7280,color:#e5e7eb;\n  class CLI,LOM,LMM,REG,ERR core;\n  class EXT,TRANS,SSH,SSM,NODE,PLUG edge;</code></pre>"},{"location":"architecture/#execution-flow","title":"Execution flow","text":"<ol> <li>CLI creates an RCS action execution request.</li> <li>LOM validates inputs and selects the action definition from the registry.</li> <li>LMM selects transport and invokes the plugin on the target node.</li> <li>Plugin receives BPCS input JSON on stdin.</li> <li>Plugin emits one JSON object on stdout and exits with a meaningful code.</li> <li>LMM validates output. On success it returns a structured response. On failure it emits EPS.</li> <li>CLI prints the result.</li> </ol>"},{"location":"architecture/#protocol-mapping","title":"Protocol mapping","text":"<ul> <li>RCS: CLI to LOM to LMM runtime messages</li> <li>MRS: registry entries for modules and actions</li> <li>BPCS: plugin stdin and stdout contract</li> <li>EPS: error envelopes routed to ErrorHandler</li> </ul> <p>See the protocol pages for details: RCS, MRS, BPCS, EPS.</p> <p>See also: JSON appendix.</p>"},{"location":"bash_library_reference/","title":"RUNE Bash Plugin Guide (BPCS)","text":"<p>This guide explains how to write Bash plugins that can be executed by the RUNE framework using the Bash Plugin Communication Specification (BPCS).</p> <p>If you can write a shell script and you can survive <code>jq</code>, you are qualified.</p>"},{"location":"bash_library_reference/#the-rules-that-matter","title":"The rules that matter","text":"<ol> <li>Your plugin reads exactly one JSON object from stdin.</li> <li>Your plugin writes exactly one JSON object to stdout.</li> <li>Everything else goes to stderr.</li> <li>Your exit code must match the outcome.</li> <li>Never print secrets.</li> </ol> <p>RUNE (via the Local Mediation Module) treats stdout as the machine contract. If you print anything other than the final JSON to stdout, you will break the contract.</p>"},{"location":"bash_library_reference/#required-dependency","title":"Required dependency","text":"<ul> <li><code>jq</code> is required. This is non negotiable if you want reliable JSON handling.</li> </ul>"},{"location":"bash_library_reference/#bpcs-message-shapes","title":"BPCS message shapes","text":""},{"location":"bash_library_reference/#input-message-stdin","title":"Input message (stdin)","text":"<p>Your plugin receives a single JSON object with these top level keys:</p> <ul> <li><code>message_metadata</code> (object)</li> <li><code>payload</code> (object)</li> <li><code>observability</code> (object)</li> </ul> <p><code>payload</code> includes:</p> <ul> <li><code>input_parameters</code> (object): the arguments to your plugin</li> <li><code>context</code> (object): shared request context from RUNE</li> </ul> <p>Example:</p> <pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"mid-123\",\n    \"correlation_id\": \"corr-abc\",\n    \"created_at\": \"2025-12-20T12:00:00.000Z\"\n  },\n  \"payload\": {\n    \"input_parameters\": {\n      \"service\": \"sshd\",\n      \"restart\": true\n    },\n    \"context\": {\n      \"node\": \"venger\",\n      \"requested_by\": \"rich\"\n    }\n  },\n  \"observability\": {\n    \"trace_id\": \"trace-1\",\n    \"span_id\": \"span-1\"\n  }\n}\n</code></pre>"},{"location":"bash_library_reference/#output-message-stdout","title":"Output message (stdout)","text":"<p>Your plugin must emit a single JSON object with these top level keys:</p> <ul> <li><code>message_metadata</code> (object)</li> <li><code>payload</code> (object or null)</li> <li><code>observability</code> (object)</li> <li><code>error</code> (object or null)</li> </ul> <p>Success output:</p> <pre><code>{\n  \"message_metadata\": { \"...\": \"...\" },\n  \"payload\": {\n    \"result\": \"success\",\n    \"output_data\": { \"...\": \"...\" }\n  },\n  \"observability\": { \"...\": \"...\" },\n  \"error\": null\n}\n</code></pre> <p>Error output:</p> <pre><code>{\n  \"message_metadata\": { \"...\": \"...\" },\n  \"payload\": null,\n  \"observability\": { \"...\": \"...\" },\n  \"error\": {\n    \"code\": 2,\n    \"message\": \"Resource not found\",\n    \"details\": { \"...\": \"...\" }\n  }\n}\n</code></pre>"},{"location":"bash_library_reference/#standard-exit-codes-and-error-codes","title":"Standard exit codes and error codes","text":"<p>Bash exit codes are 0 to 255. BPCS standard codes stay safely inside that range.</p> <p>Use these codes consistently:</p> <ul> <li><code>0</code> success</li> <li><code>1</code> validation error (bad input)</li> <li><code>2</code> resource or dependency error (file missing, network failure, command unavailable)</li> <li><code>3</code> business logic failure (the action ran, but failed to do the intended thing)</li> <li><code>4</code> configuration error (missing env var, missing config, wrong OS assumption)</li> <li><code>100</code> unhandled exception or system error (unexpected fatal conditions)</li> </ul> <p>In this library, the exit code is the same as <code>error.code</code> on failures.</p>"},{"location":"bash_library_reference/#using-the-shared-library","title":"Using the shared library","text":"<p>RUNE provides <code>rune_bpcs.sh</code> as a shared library. Your plugin should source it and then call <code>rune_init</code> immediately.</p>"},{"location":"bash_library_reference/#minimal-plugin-template-easy-mode","title":"Minimal plugin template (easy mode)","text":"<pre><code>#!/usr/bin/env bash\nset -euo pipefail\n\nSCRIPT_DIR=$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" &amp;&amp; pwd)\nsource \"${SCRIPT_DIR}/rune_bpcs.sh\"\n\nrune_init\n\nSERVICE=\"$(rune_param service \"\")\"\nif [[ -z \"${SERVICE}\" ]]; then\n  rune_error 1 \"Missing required parameter: service\" '{\"missing\":[\"service\"]}'\nfi\n\n# Do the work\nif systemctl restart \"${SERVICE}\" 2&gt;/dev/null; then\n  OUT=\"$(jq -nc --arg svc \"${SERVICE}\" '{service:$svc, restarted:true}')\"\n  rune_ok \"Service restarted\" \"${OUT}\"\nelse\n  DETAILS=\"$(jq -nc --arg svc \"${SERVICE}\" '{service:$svc, restarted:false}')\"\n  rune_error 2 \"Failed to restart service\" \"${DETAILS}\"\nfi\n</code></pre>"},{"location":"bash_library_reference/#reading-input","title":"Reading input","text":""},{"location":"bash_library_reference/#parameters","title":"Parameters","text":"<ul> <li> <p><code>rune_param KEY DEFAULT</code>   Returns a parameter as a string.</p> </li> <li> <p><code>rune_param_json KEY DEFAULT_JSON</code>   Returns a parameter as JSON.</p> </li> <li> <p><code>rune_all_params</code>   Returns the full <code>input_parameters</code> object as JSON.</p> </li> </ul> <p>Examples:</p> <pre><code>SERVICE=\"$(rune_param service \"\")\"\nRESTART=\"$(rune_param restart \"false\")\"           # \"true\" or \"false\"\nRAW_PARAMS_JSON=\"$(rune_all_params)\"              # JSON object string\n</code></pre>"},{"location":"bash_library_reference/#context","title":"Context","text":"<ul> <li><code>rune_ctx KEY DEFAULT</code></li> <li><code>rune_ctx_json KEY DEFAULT_JSON</code></li> <li><code>rune_all_ctx</code></li> </ul> <p>Examples:</p> <pre><code>NODE=\"$(rune_ctx node \"unknown\")\"\nCTX_JSON=\"$(rune_all_ctx)\"\n</code></pre>"},{"location":"bash_library_reference/#metadata-and-observability","title":"Metadata and observability","text":"<ul> <li> <p><code>rune_meta KEY DEFAULT</code>   Looks up the key in <code>message_metadata</code>, then falls back to <code>observability</code>.</p> </li> <li> <p><code>rune_obs KEY DEFAULT</code>   Looks up the key only in <code>observability</code>.</p> </li> </ul> <p>Examples:</p> <pre><code>MESSAGE_ID=\"$(rune_meta message_id \"\")\"\nTRACE_ID=\"$(rune_meta trace_id \"none\")\"   # works via fallback\nSPAN_ID=\"$(rune_obs span_id \"none\")\"\n</code></pre>"},{"location":"bash_library_reference/#writing-output","title":"Writing output","text":""},{"location":"bash_library_reference/#rune_ok-message-output_data_json","title":"<code>rune_ok MESSAGE OUTPUT_DATA_JSON</code>","text":"<p>Emits a full BPCS success message and exits <code>0</code>.</p> <p><code>OUTPUT_DATA_JSON</code> must be a JSON object string. Use <code>jq -nc</code> to build it safely.</p> <p>Note: <code>MESSAGE</code> is injected into <code>output_data.message</code> only if you did not already provide a <code>message</code> key.</p>"},{"location":"bash_library_reference/#rune_error-code-message-details_json","title":"<code>rune_error CODE MESSAGE DETAILS_JSON</code>","text":"<p>Emits a full BPCS error message and exits <code>CODE</code>.</p> <p><code>DETAILS_JSON</code> must be a JSON object string. Use <code>jq -nc</code> to build it safely.</p>"},{"location":"bash_library_reference/#convenience-helpers","title":"Convenience helpers","text":"<p>If you prefer simple key value output without thinking about JSON types:</p> <ul> <li><code>rune_ok_kv \"message\" \"key=value\" \"key2=value2\"</code></li> <li><code>rune_error_kv 2 \"message\" \"key=value\"</code></li> </ul> <p>All values become strings in these helpers.</p>"},{"location":"bash_library_reference/#accumulator-style","title":"Accumulator style","text":"<p>For longer scripts, you can accumulate output fields and finish once:</p> <pre><code>rune_out \"service=$SERVICE\"\nrune_out \"attempted_restart=true\"\n\nif ! systemctl restart \"$SERVICE\"; then\n  rune_err 2 \"Restart failed\"\nfi\n\nrune_finish \"completed\"\n</code></pre> <ul> <li>If no error was recorded, <code>rune_finish</code> emits success.</li> <li>If an error was recorded, <code>rune_finish</code> emits error using the accumulated output as <code>error.details</code>.</li> </ul>"},{"location":"bash_library_reference/#advanced-mode","title":"Advanced mode","text":"<p>If you want full control, build the entire BPCS output JSON yourself and then call <code>rune_emit</code>.</p> <p>This is useful when: - you already have a full JSON response constructed - you need to emit a very specific output shape - you want to validate that your response is BPCS compliant before printing it</p> <p>Example:</p> <pre><code>OUT=\"$(jq -nc '{something:\"custom\"}')\"\n\nRESP=\"$(jq -nc \\\n  --argjson mm \"${RUNE_MESSAGE_METADATA}\" \\\n  --argjson obs \"${RUNE_OBSERVABILITY}\" \\\n  --argjson out \"${OUT}\" \\\n  '{\n    message_metadata: $mm,\n    payload: {result:\"success\", output_data:$out},\n    observability: $obs,\n    error: null\n  }'\n)\"\n\nrune_emit \"${RESP}\" 0\n</code></pre> <p><code>rune_emit</code> validates the JSON is BPCS compliant, prints it, and exits.</p>"},{"location":"bash_library_reference/#testing-locally","title":"Testing locally","text":"<p>Create an input file:</p> <pre><code>cat &gt; input.json &lt;&lt;'JSON'\n{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"mid-test\",\n    \"created_at\": \"2025-12-20T12:00:00Z\"\n  },\n  \"payload\": {\n    \"input_parameters\": { \"mode\": \"easy\" },\n    \"context\": { \"node\": \"local\" }\n  },\n  \"observability\": {\n    \"trace_id\": \"trace-test\",\n    \"span_id\": \"span-test\"\n  }\n}\nJSON\n</code></pre> <p>Run the plugin:</p> <pre><code>cat input.json | ./noop.sh | jq\necho \"exit=$?\"\n</code></pre> <p>To force an error response in the provided noop test plugin:</p> <pre><code>cat input.json | jq '.payload.input_parameters.fail=\"true\"' | ./noop.sh | jq\necho \"exit=$?\"\n</code></pre>"},{"location":"bash_library_reference/#common-failure-modes","title":"Common failure modes","text":"<ul> <li>Printing debug output to stdout instead of stderr</li> <li>Forgetting <code>rune_init</code></li> <li>Building JSON by string concatenation instead of <code>jq</code></li> <li>Returning non JSON on error paths</li> <li>Exiting non zero without emitting a BPCS error message</li> <li>Putting arrays or objects into <code>rune_ok_kv</code> and expecting them to stay typed (they become strings)</li> </ul>"},{"location":"bash_library_reference/#quick-checklist","title":"Quick checklist","text":"<ul> <li>[ ] <code>source rune_bpcs.sh</code></li> <li>[ ] <code>rune_init</code> is called before you read parameters</li> <li>[ ] stdout contains exactly one JSON object at the end</li> <li>[ ] stderr contains any diagnostics</li> <li>[ ] success uses exit 0</li> <li>[ ] failures use an <code>error</code> object and non zero exit code</li> </ul>"},{"location":"bpcs/","title":"Bash Plugin Communication Specification (BPCS)","text":"<p>This is the canonical stdin and stdout contract for RUNE Bash plugins.</p> <p>The recommended implementation uses the shared Bash library documented in Bash library reference.</p>"},{"location":"bpcs/#overview","title":"Overview","text":"<p>The Bash Plugin Communication Specification (BPCS) defines the standard interface for data exchange between Bash script plugins and the RUNE platform. All plugin communication-input, output, and error handling-is strictly mediated by the RUNE Mediator Module (LMM). No direct communication between plugins and modules, or between plugins, is permitted.</p> <p>BPCS ensures robust, consistent, and observable integration of Bash plugins, supporting modularity, observability, and system stability.</p> <p>Key Principles:</p> <ul> <li>Strict Mediation: All plugin invocation, input, output, and errors flow through the LMM.</li> <li>No Direct Plugin Communication: Plugins cannot send messages directly to modules or to one another.</li> <li>Standardized Input/Output: All plugin messages are structured as JSON.</li> <li>Observability: All plugin executions are traceable via LMM-managed IDs and logs.</li> <li>Robust Error Handling: Plugins follow strict exit code and error payload conventions.</li> <li>Security: Data is sanitized and all communication is managed by the LMM.</li> </ul>"},{"location":"bpcs/#protocol-architecture-context","title":"Protocol Architecture Context","text":"<p>BPCS operates as the contract governing all Bash plugin interactions:</p> Protocol Purpose Managed By Frequency MRS Module/Plugin registration/capability declaration Orchestrator (LOM) Low (startup/shutdown) RCS Runtime operational communication Mediator (LMM) High (continuous) EPS Error handling and recovery messaging Mediator (LMM) + ErrorHandler Variable (exception-based) BPCS Bash plugin interface definition Mediator (LMM) Variable (plugin invocation) <p>Integration Points:</p> <ul> <li>Mediator (LMM): Sole invoker and mediator for Bash plugins-handles all input, output, and error capture.</li> <li>Orchestrator (LOM): Handles plugin registration and lifecycle management.</li> <li>Plugins: Must comply with this specification for all communications.</li> <li>Observability: All plugin executions are traceable via LMM-managed IDs and logs.</li> </ul>"},{"location":"bpcs/#when-to-use-this-specification","title":"When to Use This Specification","text":"Use Case Protocol Purpose Plugin executes business logic BPCS Structured input/output for normal operations Plugin returns data to framework BPCS Standard result reporting Plugin encounters an error BPCS Structured error response, supports EPS Plugin needs traceability BPCS Observability metadata (trace_id, span_id) Operational messaging RCS Core-to-core, non-plugin module communication Module registration MRS Capability declaration Error escalation EPS Framework-level error routing <p>Decision Rule: Use BPCS for all data exchange between Bash plugins and the RUNE framework (input and output). Use EPS for system-level errors outside plugin execution.</p>"},{"location":"bpcs/#communication-message-structure","title":"Communication Message Structure","text":"<p>All communication between Bash plugins and the RUNE framework is performed using JSON-encoded messages via standard input (<code>stdin</code>) and output (<code>stdout</code>). Plugins may also write diagnostic details to standard error (<code>stderr</code>).</p>"},{"location":"bpcs/#complete-format-example","title":"Complete Format Example","text":""},{"location":"bpcs/#input-message-from-rune-to-plugin","title":"Input Message (from RUNE to Plugin)","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"b4f1c9d4-7f2d-4c5b-90a0-cf5d2c8e3b12\",\n    \"correlation_id\": \"workflow-abc-123\",\n    \"created_at\": \"2025-08-03T16:35:00.000Z\"\n  },\n  \"payload\": {\n    \"input_parameters\": {\n      \"email_address\": \"user@example.com\",\n      \"template_id\": \"welcome-2025\"\n    },\n    \"context\": {\n      \"user_id\": \"user-001\",\n      \"triggered_by\": \"registration\"\n    }\n  },\n  \"observability\": {\n    \"trace_id\": \"trace-abc-001\",\n    \"span_id\": \"span-bash-plugin-001\"\n  }\n}\n</code></pre>"},{"location":"bpcs/#output-message-from-plugin-to-rune","title":"Output Message (from Plugin to RUNE)","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"b4f1c9d4-7f2d-4c5b-90a0-cf5d2c8e3b12\",\n    \"correlation_id\": \"workflow-abc-123\",\n    \"created_at\": \"2025-08-03T16:35:01.123Z\"\n  },\n  \"payload\": {\n    \"result\": \"success\",\n    \"output_data\": {\n      \"email_sent\": true,\n      \"delivery_id\": \"deliv-12345\"\n    }\n  },\n  \"observability\": {\n    \"trace_id\": \"trace-abc-001\",\n    \"span_id\": \"span-bash-plugin-001\"\n  },\n  \"error\": null\n}\n</code></pre>"},{"location":"bpcs/#output-message-error-case","title":"Output Message (Error Case)","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"b4f1c9d4-7f2d-4c5b-90a0-cf5d2c8e3b12\",\n    \"correlation_id\": \"workflow-abc-123\",\n    \"created_at\": \"2025-08-03T16:35:01.234Z\"\n  },\n  \"payload\": null,\n  \"observability\": {\n    \"trace_id\": \"trace-abc-001\",\n    \"span_id\": \"span-bash-plugin-001\"\n  },\n  \"error\": {\n    \"code\": 1001,\n    \"message\": \"Template not found\",\n    \"details\": {\n      \"template_id\": \"welcome-2025\"\n    }\n  }\n}\n</code></pre>"},{"location":"bpcs/#field-specifications","title":"Field Specifications","text":""},{"location":"bpcs/#message-metadata-section","title":"Message Metadata Section","text":"Field Type Required Purpose <code>version</code> String Yes Protocol version (current: \"1.0\") <code>message_id</code> String Yes Unique identifier for this message <code>correlation_id</code> String No Correlates request/response (tracing) <code>created_at</code> String Yes RFC 3339 timestamp, UTC"},{"location":"bpcs/#payload-section","title":"Payload Section","text":"Field Type Required Purpose <code>input_parameters</code> Object Input Named parameters for plugin logic <code>context</code> Object Input Workflow/user context for plugin <code>result</code> String Output <code>\"success\"</code> or <code>\"failure\"</code> <code>output_data</code> Object Output Plugin-specific output"},{"location":"bpcs/#error-section","title":"Error Section","text":"Field Type Required Purpose <code>code</code> Integer Output Numeric error code (see below) <code>message</code> String Output Human-readable error message <code>details</code> Object Output Additional error data/context"},{"location":"bpcs/#observability-section","title":"Observability Section","text":"Field Type Required Purpose <code>trace_id</code> String Yes Distributed tracing identifier <code>span_id</code> String Yes Execution span identifier"},{"location":"bpcs/#standard-outputexit-code-conventions","title":"Standard Output/Exit Code Conventions","text":"Plugin Behavior stdout stderr exit code Success JSON output (optional logs) 0 Non-fatal error JSON error object (optional logs) 1 Fatal/system error JSON error object Error details/logs &gt;1 <ul> <li>All plugin output must be a single JSON object written to stdout.</li> <li>stderr may be used for diagnostics, stack traces, or debug logs (not structured).</li> <li>Exit codes are mandatory and must be interpreted by the LMM.</li> </ul>"},{"location":"bpcs/#standard-error-codes-and-responses","title":"Standard Error Codes and Responses","text":"Code Meaning When to Use 0 Success Normal operation, result in payload 1 Plugin validation error Input parameter validation failed 2 Resource or dependency error File, network, or external resource 3 Business logic failure Application logic failed 4 Configuration error Missing/invalid env or config 100 Unhandled exception/system error Unexpected fatal error <p>All error codes &gt;= 1 must include a populated <code>error</code> object in the plugin output.</p>"},{"location":"bpcs/#plugin-invocation-and-data-flow","title":"Plugin Invocation and Data Flow","text":"<ol> <li>Mediator (LMM) prepares input message</li> <li>Populates all metadata, input parameters, context, and observability fields.</li> <li>Mediator (LMM) invokes plugin</li> <li>Plugin receives input as JSON via stdin.</li> <li>Plugin processes request</li> <li>Writes structured JSON output to stdout (and optional logs to stderr).</li> <li>Mediator (LMM) captures stdout/stderr/exit code</li> <li>Parses stdout as JSON for result or error.</li> <li>Handles exit code according to convention.</li> <li>Mediator (LMM) routes output</li> <li>On success, output is routed to consumer(s) via LMM.</li> <li>On error, output is processed per EPS and logged/escalated via LMM.</li> </ol>"},{"location":"bpcs/#error-handling-and-recovery","title":"Error Handling and Recovery","text":"<ul> <li>Plugins must always return a valid JSON output message, even on error.</li> <li>The <code>error</code> section must be present and populated if exit code != 0.</li> <li>Framework will escalate severe/fatal errors using EPS protocol.</li> <li>Plugin errors should include actionable guidance in the <code>details</code> field where possible.</li> </ul>"},{"location":"bpcs/#example-communication-messages","title":"Example Communication Messages","text":""},{"location":"bpcs/#success","title":"Success","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"a1b2c3d4-e5f6-7890-1234-56789abcdef0\",\n    \"correlation_id\": \"workflow-xyz-789\",\n    \"created_at\": \"2025-08-03T16:36:00.000Z\"\n  },\n  \"payload\": {\n    \"result\": \"success\",\n    \"output_data\": {\n      \"user_created\": true,\n      \"user_id\": \"user-999\"\n    }\n  },\n  \"observability\": {\n    \"trace_id\": \"trace-xyz-002\",\n    \"span_id\": \"span-plugin-user-creation\"\n  },\n  \"error\": null\n}\n</code></pre>"},{"location":"bpcs/#input-validation-error","title":"Input Validation Error","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"b2c3d4e5-f6a7-8901-2345-6789abcdef01\",\n    \"correlation_id\": \"workflow-xyz-789\",\n    \"created_at\": \"2025-08-03T16:36:10.000Z\"\n  },\n  \"payload\": null,\n  \"observability\": {\n    \"trace_id\": \"trace-xyz-002\",\n    \"span_id\": \"span-plugin-user-creation\"\n  },\n  \"error\": {\n    \"code\": 1,\n    \"message\": \"Missing required parameter: email_address\",\n    \"details\": {\n      \"parameter\": \"email_address\"\n    }\n  }\n}\n</code></pre>"},{"location":"bpcs/#fatal-error","title":"Fatal Error","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"e5f6a7b8-c9d0-1234-5678-9abcdef01234\",\n    \"correlation_id\": \"workflow-xyz-789\",\n    \"created_at\": \"2025-08-03T16:36:20.000Z\"\n  },\n  \"payload\": null,\n  \"observability\": {\n    \"trace_id\": \"trace-xyz-002\",\n    \"span_id\": \"span-plugin-user-creation\"\n  },\n  \"error\": {\n    \"code\": 100,\n    \"message\": \"Unexpected system failure\",\n    \"details\": {\n      \"exception\": \"Segmentation fault\",\n      \"hint\": \"Check plugin dependencies and memory limits\"\n    }\n  }\n}\n</code></pre>"},{"location":"bpcs/#minimal-required-communication-message","title":"Minimal Required Communication Message","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"minimal-uuid-001\",\n    \"created_at\": \"2025-08-03T16:37:00.000Z\"\n  },\n  \"payload\": {\n    \"result\": \"success\"\n  },\n  \"observability\": {\n    \"trace_id\": \"minimal-trace-001\",\n    \"span_id\": \"minimal-span-001\"\n  }\n}\n</code></pre>"},{"location":"bpcs/#implementation-guidelines","title":"Implementation Guidelines","text":"<ul> <li>Input Parsing: Always read stdin as a single JSON object; exit with code 1 and an error message if parsing fails.</li> <li>Output Writing: Output must be a single line JSON object to stdout; multiline or non-JSON output is not accepted.</li> <li>Error Handling: Always populate the <code>error</code> field on failure, never mix error and output data in the same message.</li> <li>Observability: Propagate <code>trace_id</code> and <code>span_id</code> from input to output for full traceability.</li> <li>Exit Codes: Always use the conventions described above; never exit with 0 on error or with &gt;0 on success.</li> <li>Security: Never echo sensitive information in payloads or logs; sanitize all outputs.</li> </ul>"},{"location":"bpcs/#security-and-safety-mechanisms","title":"Security and Safety Mechanisms","text":"<ol> <li>Input Validation: Reject malformed or unexpected input with a structured error response.</li> <li>Execution Isolation: Plugins run in a sandboxed environment managed by the framework.</li> <li>Sensitive Data Handling: Do not log secrets or credentials.</li> <li>Timeouts: Plugins exceeding allowed execution time are terminated by the framework.</li> <li>Error Escalation: Fatal errors are routed to the ErrorHandler via EPS.</li> <li>Resource Limits: Controlled via framework (CPU, memory, disk).</li> <li>Fallback Handling: On plugin crash without valid output, the framework generates a protocol-compliant fatal error message.</li> </ol> <p>This Bash Plugin Communication Specification ensures robust, predictable, and secure integration of Bash plugins within the RUNE platform, supporting modularity, observability, and system stability.</p>"},{"location":"contributing/","title":"Contributing","text":"<p>RUNE is built to be useful in real corporate IT and security operations. Contributions are welcome when they improve clarity, safety, and operational practicality.</p>"},{"location":"contributing/#what-to-contribute","title":"What to contribute","text":"<ul> <li>documentation fixes and improvements</li> <li>protocol clarifications with concrete examples</li> <li>transport adapters (SSH improvements, SSM support)</li> <li>plugin development tooling</li> <li>test harnesses and sample plugins</li> </ul>"},{"location":"contributing/#guiding-rules","title":"Guiding rules","text":"<ul> <li>Protocol documents are contracts. Changes must be deliberate and versioned.</li> <li>Avoid breaking changes to message envelopes without a migration story.</li> <li>Favor explicit, boring behavior over clever implicit behavior.</li> <li>Add tests for any behavior that affects routing, output, or error handling.</li> </ul>"},{"location":"contributing/#pull-requests","title":"Pull requests","text":"<p>A good PR includes:</p> <ul> <li>a clear problem statement</li> <li>a short description of the operational impact</li> <li>documentation updates if behavior changes</li> <li>tests where applicable</li> </ul>"},{"location":"contributing/#security","title":"Security","text":"<p>If you find a security issue, do not publish it as an issue. Provide a responsible disclosure report through the repository\u2019s security contact mechanism.</p>"},{"location":"diagrams/","title":"Diagrams","text":"<p>This page consolidates key diagrams used throughout the documentation. Individual pages link here to avoid repeating diagrams.</p>"},{"location":"diagrams/#system-context","title":"System context","text":"<pre><code>flowchart LR\n  O[Operator / Automation] --&gt; CLI[CLI]\n  CLI --&gt; LOM[LOM Orchestrator]\n  LOM --&gt; LMM[LMM Mediator]\n  LMM --&gt;|SSH/SSM| HOST[Remote Host]\n  HOST --&gt; PLUG[Plugin Script]\n  PLUG --&gt; HOST --&gt; LMM --&gt; LOM --&gt; CLI</code></pre>"},{"location":"diagrams/#positioning-in-the-automation-stack","title":"Positioning in the automation stack","text":"<pre><code>flowchart TB\n  A[Signals &amp; Triggers&lt;br/&gt;Monitoring \u2022 SIEM \u2022 SOAR \u2022 ITSM \u2022 On-call] --&gt; B[RUNE&lt;br/&gt;Mediated remediation orchestration]\n\n  B --&gt; C[Action Plugins&lt;br/&gt;Bash/Python \u2022 strict I/O]\n  B --&gt; D[CM / Automation Tools&lt;br/&gt;Ansible \u2022 Salt \u2022 Puppet \u2022 Chef&lt;br/&gt;Terraform adjacent]\n\n  C --&gt; E[Execution Transport&lt;br/&gt;SSH \u2022 AWS SSM]\n  E --&gt; F[Targets&lt;br/&gt;Linux hosts \u2022 instances \u2022 customer-managed envs]\n\n  D -. optional invocation .-&gt; E</code></pre>"},{"location":"diagrams/#runtime-execution-sequence","title":"Runtime execution sequence","text":"<pre><code>sequenceDiagram\n  participant CLI\n  participant LOM\n  participant LMM\n  participant HOST as Remote Host\n  participant PLUG as Plugin\n\n  CLI-&gt;&gt;LOM: RCS execute_action\n  LOM-&gt;&gt;LMM: RCS route/validate\n  LMM-&gt;&gt;HOST: SSH/SSM run plugin\n  HOST-&gt;&gt;PLUG: BPCS stdin JSON\n  PLUG--&gt;&gt;HOST: BPCS stdout JSON + exit code\n  HOST--&gt;&gt;LMM: stdout/stderr/exit\n  LMM--&gt;&gt;LOM: RCS response (result) or EPS\n  LOM--&gt;&gt;CLI: CLI JSON output</code></pre>"},{"location":"diagrams/#module-registration-flow","title":"Module registration flow","text":"<pre><code>flowchart LR\n  MOD[Module / Plugin] --&gt;|MRS register| LOM[LOM Registry Owner]\n  LOM --&gt;|registry snapshot/query| LMM[LMM Router]\n  LMM --&gt;|route decision| EXEC[Execution Path]</code></pre>"},{"location":"diagrams/#error-handling-flow","title":"Error handling flow","text":"<pre><code>flowchart TB\n  R[RCS request received] --&gt; V[Validate request]\n  V --&gt; X[Execute via LMM]\n  X --&gt; P[Parse plugin output]\n  P --&gt;|ok + exit=0| S[RCS success response]\n  P --&gt;|invalid JSON or exit!=0| M[Map to EPS]\n  M --&gt; H[Route EPS to ErrorHandler]\n  H --&gt; E[RCS error response]</code></pre>"},{"location":"diagrams/#mediation-boundary","title":"Mediation boundary","text":"<pre><code>flowchart LR\n  subgraph \"RUNE\"\n    CLI[CLI] --&gt; LOM[LOM]\n    LOM --&gt; LMM[LMM]\n    A[Module A] --&gt; LMM\n    B[Module B] --&gt; LMM\n    ERR[ErrorHandler] --&gt; LMM\n  end\n\n  A -. \"no direct module-to-module\" .- B</code></pre>"},{"location":"diagrams/#policy-gates","title":"Policy gates","text":"<pre><code>flowchart TB\n  IN[RCS request] --&gt; VAL[Validate schema + routing]\n  VAL --&gt;|reject| EPS[Emit EPS]\n  VAL --&gt; POL[Policy gates&lt;br/&gt;allowlist \u2022 rate limit \u2022 safeguards]\n  POL --&gt;|reject| EPS\n  POL --&gt; MODE[Select mode&lt;br/&gt;local or remote]\n  MODE --&gt; RUN[Invoke plugin]\n  RUN --&gt; OUT[Validate plugin output]\n  OUT --&gt;|success| OK[RCS result]\n  OUT --&gt;|failure| EPS</code></pre>"},{"location":"diagrams/#plugin-lifecycle","title":"Plugin lifecycle","text":"<pre><code>stateDiagram-v2\n  [*] --&gt; Discovered\n  Discovered --&gt; Validated\n  Validated --&gt; Runnable\n  Runnable --&gt; Executing\n  Executing --&gt; Succeeded: exit=0 + valid JSON\n  Executing --&gt; Failed: exit!=0 or invalid JSON\n  Failed --&gt; Quarantined: repeated failure (optional)\n  Quarantined --&gt; Runnable: manual restore (optional)</code></pre>"},{"location":"eps/","title":"Error Protocol Specification (EPS)","text":"<p>This is the canonical error envelope used by RUNE when failures must propagate through the platform and be handled consistently.</p> <p>For plugin level errors, see BPCS.</p>"},{"location":"eps/#overview","title":"Overview","text":"<p>he Error Protocol Specification (EPS) defines the standardized data format for all error communication within the RUNE platform. All error reporting-whether originating from a module or a plugin-is strictly routed through the RUNE Mediator Module (LMM) to the ErrorHandler module. No direct error communication between modules, or between modules and plugins, is permitted.</p> <p>EPS ensures consistent error handling, reporting, and recovery across all modules and plugins while maintaining the platform's architecture of strict mediation and loose coupling.</p> <p>All errors, whether originating from a core module or a plugin (e.g. Bash plugin), are reported via standardized EPS messages and routed exclusively through the LMM. Plugins never send error messages directly to modules or error handlers.</p> <p>Key Principles:</p> <ul> <li>Centralized Error Routing: All errors flow through the Mediator to registered ErrorHandler modules</li> <li>Comprehensive Context: Error messages include full diagnostic information for effective troubleshooting</li> <li>Recovery Guidance: Errors include actionable recovery recommendations</li> <li>System Stability: Built-in safeguards prevent error handling loops and cascading failures</li> </ul>"},{"location":"eps/#protocol-architecture-context","title":"Protocol Architecture Context","text":"<p>The RUNE platform operates on a three-protocol architecture:</p> Protocol Purpose Managed By Frequency MRS Module registration and capability declaration Orchestrator Low (startup/shutdown) RCS Runtime operational communication Mediator High (continuous) EPS Error handling and recovery messaging Mediator + ErrorHandler Variable (exception-based) <p>Integration Points:</p> <ul> <li>Orchestrator: Maintains module registry used by Mediator for error routing decisions</li> <li>Mediator: Routes all error messages and enforces communication protocols</li> <li>ErrorHandler Module: Processes errors, manages recovery, and handles escalation</li> </ul>"},{"location":"eps/#when-to-use-this-specification","title":"When to Use This Specification","text":"Use Case Protocol Purpose JSON Parse Failures EPS Malformed message structure errors Schema Validation Errors EPS RCS/MRS message validation failures Module Not Found EPS Routing failures for unregistered modules Timeout Errors EPS Message delivery or response timeouts Authentication/Authorization Failures EPS Security-related access errors Business Logic Errors EPS Module-specific operational failures System Resource Errors EPS Memory, disk, network, or CPU failures Module Registration MRS Declaring capabilities and subscribing to events Operational Communication RCS Normal module-to-module messaging <p>Decision Rule: Use EPS whenever any component detects an error condition that prevents normal message processing or operation completion.</p>"},{"location":"eps/#error-message-structure","title":"Error Message Structure","text":""},{"location":"eps/#complete-format-example","title":"Complete Format Example","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"correlation_id\": \"original-request-correlation-id\",\n    \"parent_message_id\": \"original-request-message-id\",\n    \"created_at\": \"2025-07-31T16:54:24.123Z\",\n    \"priority\": \"high\"\n  },\n  \"routing\": {\n    \"event_type\": \"EPS_ERROR_RESPONSE\",\n    \"event_category\": \"error_handling\",\n    \"source_module\": \"Mediator\",\n    \"target_module\": \"ErrorHandler_Core\",\n    \"original_source_module\": \"DataProcessor\",\n    \"routing_tags\": [\"validation_error\", \"schema_failure\"]\n  },\n  \"error_payload\": {\n    \"schema_version\": \"1.0\",\n    \"content_type\": \"application/json\",\n    \"size_bytes\": 456,\n    \"error_data\": {\n      \"jsonrpc\": \"2.0\",\n      \"error\": {\n        \"code\": -32602,\n        \"message\": \"Invalid params\",\n        \"data\": {\n          \"field\": \"payload.data.email_address\",\n          \"reason\": \"Invalid email format provided\",\n          \"timestamp\": \"2025-07-31T16:54:24.123Z\",\n          \"validation_errors\": [\n            \"Email address must contain @ symbol\",\n            \"Domain portion must contain at least one dot\"\n          ],\n          \"original_value\": \"invalid-email-format\",\n          \"expected_format\": \"user@domain.com\"\n        }\n      },\n      \"id\": \"original-request-message-id\"\n    },\n    \"error_context\": {\n      \"error_classification\": \"validation_error\",\n      \"severity\": \"medium\",\n      \"recoverable\": true,\n      \"retry_recommended\": false,\n      \"escalation_required\": false,\n      \"recovery_actions\": [\n        \"Validate email format before sending\",\n        \"Use email validation library\",\n        \"Provide user-friendly error message\"\n      ],\n      \"related_errors\": [],\n      \"system_impact\": \"single_request\",\n      \"module_health_impact\": \"none\"\n    }\n  },\n  \"observability\": {\n    \"trace_id\": \"error-trace-001\",\n    \"span_id\": \"validation-error-span\",\n    \"error_fingerprint\": \"schema_validation_email_format_001\"\n  }\n}\n</code></pre>"},{"location":"eps/#field-specifications","title":"Field Specifications","text":""},{"location":"eps/#message-metadata-section","title":"Message Metadata Section","text":"Field Type Required Purpose <code>version</code> String Yes EPS protocol version for backward compatibility (current: \"1.0\") <code>message_id</code> UUID String Yes Unique identifier for this error message <code>correlation_id</code> UUID String Yes Links error to original request that caused the failure <code>parent_message_id</code> UUID String Yes Message ID of the original request that generated this error <code>created_at</code> RFC 3339 String Yes Error occurrence timestamp in UTC (format: YYYY-MM-DDTHH:MM:SS.sssZ) <code>priority</code> Enum String Yes Error priority: <code>critical</code>, <code>high</code>, <code>medium</code>, <code>low</code> (based on severity mapping)"},{"location":"eps/#routing-section","title":"Routing Section","text":"Field Type Required Purpose <code>event_type</code> String Yes Always \"EPS_ERROR_RESPONSE\" for error protocol messages <code>event_category</code> String Yes Always \"error_handling\" for error classification <code>source_module</code> String Yes Module that detected and generated the error <code>target_module</code> String No Intended recipient (usually \"ErrorHandler_Core\") <code>original_source_module</code> String Yes Module that sent the original message causing the error <code>routing_tags</code> Array[String] Yes Error classification tags for routing and filtering"},{"location":"eps/#error-payload-section","title":"Error Payload Section","text":"Field Type Required Purpose <code>schema_version</code> String Yes Version of the error payload structure (current: \"1.0\") <code>content_type</code> String Yes Always \"application/json\" for EPS messages <code>size_bytes</code> Integer Yes Total size of error_data and error_context sections <code>error_data</code> Object Yes JSON-RPC 2.0 compliant error structure <code>error_context</code> Object Yes RUNE-specific error context and recovery information"},{"location":"eps/#observability-section","title":"Observability Section","text":"Field Type Required Purpose <code>trace_id</code> String Yes Distributed tracing identifier linking to original request <code>span_id</code> String Yes Specific span identifier for this error event <code>error_fingerprint</code> String Yes Unique identifier for this error type for grouping/analysis"},{"location":"eps/#json-rpc-20-error-data-structure","title":"JSON-RPC 2.0 Error Data Structure","text":"<p>The <code>error_data</code> section strictly follows JSON-RPC 2.0 specification:</p> Field Type Required Purpose <code>jsonrpc</code> String Yes Always \"2.0\" for JSON-RPC version compliance <code>error</code> Object Yes JSON-RPC error object with code, message, data <code>id</code> String Yes ID from original request (or null if not parseable)"},{"location":"eps/#json-rpc-error-object","title":"JSON-RPC Error Object","text":"Field Type Required Purpose <code>code</code> Integer Yes Numeric error code (see Standard Error Codes below) <code>message</code> String Yes Human-readable error description <code>data</code> Object No Additional error details and context"},{"location":"eps/#json-rpc-error-data-object","title":"JSON-RPC Error Data Object","text":"Field Type Required Purpose <code>field</code> String No Specific field that caused the error <code>reason</code> String Yes Detailed explanation of the error condition <code>timestamp</code> RFC 3339 String Yes When the error occurred <code>validation_errors</code> Array[String] No List of specific validation failures <code>original_value</code> Any No Value that caused the error <code>expected_format</code> String No Description of expected value format"},{"location":"eps/#standard-error-codes","title":"Standard Error Codes","text":""},{"location":"eps/#json-rpc-20-base-codes","title":"JSON-RPC 2.0 Base Codes","text":"Code Message Meaning -32700 Parse error Invalid JSON was received by the parser -32600 Invalid Request The JSON sent is not a valid Request object -32601 Method not found The method does not exist / is not available -32602 Invalid params Invalid method parameter(s) -32603 Internal error Internal JSON-RPC error -32000 to -32099 Server error Reserved for implementation-defined server-errors"},{"location":"eps/#rune-custom-error-codes","title":"RUNE Custom Error Codes","text":""},{"location":"eps/#communication-errors-32100-to-32199","title":"Communication Errors (-32100 to -32199)","text":"Code Message Meaning -32100 Module not found Target module is not registered with Orchestrator -32101 Module unavailable Target module is registered but not responding -32102 Routing failure Mediator cannot determine message destination -32103 Message too large Message exceeds maximum size limits -32104 Rate limit exceeded Sender has exceeded message rate limits -32105 Protocol version mismatch Unsupported RCS/MRS/EPS version"},{"location":"eps/#validation-errors-32200-to-32299","title":"Validation Errors (-32200 to -32299)","text":"Code Message Meaning -32200 Schema validation failed Message doesn't conform to declared schema -32201 Required field missing Mandatory field is absent from message -32202 Field type mismatch Field contains wrong data type -32203 Field value out of range Numeric or date field exceeds allowed range -32204 Invalid field format Field format doesn't match specification -32205 Checksum validation failed Message integrity check failed"},{"location":"eps/#security-errors-32300-to-32399","title":"Security Errors (-32300 to -32399)","text":"Code Message Meaning -32300 Authentication failed Invalid or missing authentication credentials -32301 Authorization denied Insufficient permissions for requested operation -32302 Signature verification failed Message signature is invalid or missing -32303 Encryption error Message encryption/decryption failed -32304 Access level insufficient Message requires higher access level -32305 Token expired Authentication token has expired"},{"location":"eps/#system-errors-32400-to-32499","title":"System Errors (-32400 to -32499)","text":"Code Message Meaning -32400 Resource exhausted System resources (memory, disk, CPU) exhausted -32401 Timeout exceeded Operation exceeded configured timeout -32402 Service unavailable Required service is temporarily unavailable -32403 Configuration error System configuration is invalid or missing -32404 Database error Database operation failed -32405 Network error Network connectivity or operation failed"},{"location":"eps/#business-logic-errors-32500-to-32599","title":"Business Logic Errors (-32500 to -32599)","text":"Code Message Meaning -32500 Business rule violation Operation violates business logic constraints -32501 Workflow state invalid Operation not allowed in current workflow state -32502 Data consistency error Operation would violate data consistency -32503 Dependency unsatisfied Required dependency is not available -32504 Operation not permitted Operation is not allowed for this entity -32505 Quota exceeded User or module has exceeded usage quota"},{"location":"eps/#error-classification-and-severity","title":"Error Classification and Severity","text":""},{"location":"eps/#error-classification-types","title":"Error Classification Types","text":"Classification Description Typical Codes Recovery Approach <code>validation_error</code> Data format or schema violations -32200 to -32299 Fix data and retry <code>communication_error</code> Message routing or delivery failures -32100 to -32199 Check module status, retry <code>security_error</code> Authentication or authorization failures -32300 to -32399 Update credentials, check permissions <code>system_error</code> Infrastructure or resource failures -32400 to -32499 Check system health, scale resources <code>business_error</code> Application logic violations -32500 to -32599 Review business rules, adjust request <code>protocol_error</code> JSON-RPC or EPS protocol violations -32700 to -32099 Fix message format, check protocol version"},{"location":"eps/#severity-levels","title":"Severity Levels","text":"Severity Priority Description Response Time Escalation <code>critical</code> critical System-wide failure, data loss risk Immediate Automatic <code>high</code> high Module failure, significant impact &lt; 5 minutes Automatic <code>medium</code> medium Feature degradation, partial failure &lt; 30 minutes Manual <code>low</code> low Minor issues, validation errors &lt; 2 hours None"},{"location":"eps/#recovery-guidance","title":"Recovery Guidance","text":"Error Context Field Purpose Values <code>recoverable</code> Can the operation be retried? <code>true</code>, <code>false</code> <code>retry_recommended</code> Should retry be attempted? <code>true</code>, <code>false</code> <code>escalation_required</code> Does this need human intervention? <code>true</code>, <code>false</code> <code>system_impact</code> How much of the system is affected? <code>single_request</code>, <code>module</code>, <code>multiple_modules</code>, <code>system_wide</code> <code>module_health_impact</code> How does this affect module health? <code>none</code>, <code>degraded</code>, <code>critical</code>, <code>failed</code>"},{"location":"eps/#error-flow-architecture","title":"Error Flow Architecture","text":"<pre><code>flowchart TD\n    A[Module A] --&gt;|Send Message| M[Mediator]\n    M --&gt;|Validate Message| M\n    M --&gt;|Error Detected| EPS{Generate EPS Error}\n    EPS --&gt;|Route Error| EH[ErrorHandler Module]\n    M --&gt;|Valid Message| B[Module B]\n\n    EH --&gt;|Process Error| EH\n    EH --&gt;|Recovery Action| M\n    M --&gt;|Recovery Command| A\n    EH --&gt;|Alert if Critical| AL[Alerting Module]\n    EH --&gt;|Log Error| LM[Logging Module]\n\n    B --&gt;|Business Error| EPS2{Generate EPS Error}\n    EPS2 --&gt;|Route Error| EH\n\n    style M fill:#ff9999,stroke:#333,stroke-width:4px\n    style EPS fill:#ffcc99,stroke:#333,stroke-width:2px\n    style EPS2 fill:#ffcc99,stroke:#333,stroke-width:2px\n    style EH fill:#99ccff,stroke:#333,stroke-width:2px</code></pre>"},{"location":"eps/#error-detection-points","title":"Error Detection Points","text":"<ol> <li>Mediator Validation: JSON parsing, schema validation, routing errors</li> <li>Module Processing: Business logic errors, resource failures</li> <li>System Level: Infrastructure failures, timeouts, security violations</li> </ol>"},{"location":"eps/#error-routing-rules","title":"Error Routing Rules","text":"<ol> <li>All errors are formatted using EPS protocol</li> <li>All errors are routed through Mediator (no direct communication)</li> <li>ErrorHandler module is the primary error processor</li> <li>Original sender receives error response via Mediator</li> <li>Critical errors trigger automatic escalation workflows</li> </ol>"},{"location":"eps/#recovery-and-escalation","title":"Recovery and Escalation","text":""},{"location":"eps/#automatic-recovery-actions","title":"Automatic Recovery Actions","text":"Error Type Recovery Action Trigger Condition <code>Module unavailable</code> Health check, restart module Module not responding <code>Rate limit exceeded</code> Queue message, retry later Rate limit threshold reached <code>Resource exhausted</code> Scale resources, alert ops Memory/CPU/disk thresholds <code>Authentication failed</code> Refresh credentials Token expired <code>Timeout exceeded</code> Retry with backoff Network or processing timeout"},{"location":"eps/#escalation-matrix","title":"Escalation Matrix","text":"Severity Time Window Actions Critical Immediate Alert on-call, auto-recovery, emergency procedures High 5 minutes Page team lead, initiate recovery, status update Medium 30 minutes Email notification, schedule review, monitor Low 2 hours Log for review, include in reports"},{"location":"eps/#example-error-messages","title":"Example Error Messages","text":""},{"location":"eps/#schema-validation-error","title":"Schema Validation Error","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"550e8400-e29b-41d4-a716-446655440001\",\n    \"correlation_id\": \"email-workflow-001\",\n    \"parent_message_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"created_at\": \"2025-07-31T16:54:24.234Z\",\n    \"priority\": \"medium\"\n  },\n  \"routing\": {\n    \"event_type\": \"EPS_ERROR_RESPONSE\",\n    \"event_category\": \"error_handling\",\n    \"source_module\": \"Mediator\",\n    \"target_module\": \"ErrorHandler_Core\",\n    \"original_source_module\": \"EmailSender\",\n    \"routing_tags\": [\"validation_error\", \"schema_failure\", \"email\"]\n  },\n  \"error_payload\": {\n    \"schema_version\": \"1.0\",\n    \"content_type\": \"application/json\",\n    \"size_bytes\": 387,\n    \"error_data\": {\n      \"jsonrpc\": \"2.0\",\n      \"error\": {\n        \"code\": -32200,\n        \"message\": \"Schema validation failed\",\n        \"data\": {\n          \"field\": \"payload.data.recipient\",\n          \"reason\": \"Email address format is invalid\",\n          \"timestamp\": \"2025-07-31T16:54:24.234Z\",\n          \"validation_errors\": [\n            \"Missing @ symbol in email address\",\n            \"Domain must contain at least one dot\"\n          ],\n          \"original_value\": \"user-invalid-email\",\n          \"expected_format\": \"user@domain.com\"\n        }\n      },\n      \"id\": \"550e8400-e29b-41d4-a716-446655440000\"\n    },\n    \"error_context\": {\n      \"error_classification\": \"validation_error\",\n      \"severity\": \"medium\",\n      \"recoverable\": true,\n      \"retry_recommended\": false,\n      \"escalation_required\": false,\n      \"recovery_actions\": [\n        \"Validate email format using regex or validation library\",\n        \"Provide user with format example\",\n        \"Implement client-side validation\"\n      ],\n      \"related_errors\": [],\n      \"system_impact\": \"single_request\",\n      \"module_health_impact\": \"none\"\n    }\n  },\n  \"observability\": {\n    \"trace_id\": \"email-workflow-trace-001\",\n    \"span_id\": \"email-validation-error\",\n    \"error_fingerprint\": \"email_validation_format_001\"\n  }\n}\n</code></pre>"},{"location":"eps/#module-not-found-error","title":"Module Not Found Error","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"550e8400-e29b-41d4-a716-446655440002\",\n    \"correlation_id\": \"data-processing-workflow-001\",\n    \"parent_message_id\": \"550e8400-e29b-41d4-a716-446655440001\",\n    \"created_at\": \"2025-07-31T16:54:24.345Z\",\n    \"priority\": \"high\"\n  },\n  \"routing\": {\n    \"event_type\": \"EPS_ERROR_RESPONSE\",\n    \"event_category\": \"error_handling\",\n    \"source_module\": \"Mediator\",\n    \"target_module\": \"ErrorHandler_Core\",\n    \"original_source_module\": \"DataOrchestrator\",\n    \"routing_tags\": [\n      \"communication_error\",\n      \"module_not_found\",\n      \"routing_failure\"\n    ]\n  },\n  \"error_payload\": {\n    \"schema_version\": \"1.0\",\n    \"content_type\": \"application/json\",\n    \"size_bytes\": 298,\n    \"error_data\": {\n      \"jsonrpc\": \"2.0\",\n      \"error\": {\n        \"code\": -32100,\n        \"message\": \"Module not found\",\n        \"data\": {\n          \"field\": \"routing.target_module\",\n          \"reason\": \"Requested module 'AdvancedAnalytics' is not registered\",\n          \"timestamp\": \"2025-07-31T16:54:24.345Z\",\n          \"original_value\": \"AdvancedAnalytics\",\n          \"expected_format\": \"Registered module name from Orchestrator registry\"\n        }\n      },\n      \"id\": \"550e8400-e29b-41d4-a716-446655440001\"\n    },\n    \"error_context\": {\n      \"error_classification\": \"communication_error\",\n      \"severity\": \"high\",\n      \"recoverable\": true,\n      \"retry_recommended\": true,\n      \"escalation_required\": true,\n      \"recovery_actions\": [\n        \"Check module registration status with Orchestrator\",\n        \"Verify module is running and healthy\",\n        \"Use alternative module if available\",\n        \"Trigger module startup if configured\"\n      ],\n      \"related_errors\": [],\n      \"system_impact\": \"multiple_modules\",\n      \"module_health_impact\": \"degraded\"\n    }\n  },\n  \"observability\": {\n    \"trace_id\": \"data-processing-trace-001\",\n    \"span_id\": \"module-routing-error\",\n    \"error_fingerprint\": \"module_not_found_advanced_analytics_001\"\n  }\n}\n</code></pre>"},{"location":"eps/#critical-system-error","title":"Critical System Error","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"550e8400-e29b-41d4-a716-446655440003\",\n    \"correlation_id\": \"system-monitor-001\",\n    \"parent_message_id\": \"550e8400-e29b-41d4-a716-446655440002\",\n    \"created_at\": \"2025-07-31T16:54:24.456Z\",\n    \"priority\": \"critical\"\n  },\n  \"routing\": {\n    \"event_type\": \"EPS_ERROR_RESPONSE\",\n    \"event_category\": \"error_handling\",\n    \"source_module\": \"SystemMonitor\",\n    \"target_module\": \"ErrorHandler_Core\",\n    \"original_source_module\": \"DataProcessor\",\n    \"routing_tags\": [\"system_error\", \"resource_exhausted\", \"critical_failure\"]\n  },\n  \"error_payload\": {\n    \"schema_version\": \"1.0\",\n    \"content_type\": \"application/json\",\n    \"size_bytes\": 445,\n    \"error_data\": {\n      \"jsonrpc\": \"2.0\",\n      \"error\": {\n        \"code\": -32400,\n        \"message\": \"Resource exhausted\",\n        \"data\": {\n          \"field\": \"system.memory\",\n          \"reason\": \"Available memory below critical threshold\",\n          \"timestamp\": \"2025-07-31T16:54:24.456Z\",\n          \"original_value\": \"95% memory usage\",\n          \"expected_format\": \"Memory usage below 85%\"\n        }\n      },\n      \"id\": \"550e8400-e29b-41d4-a716-446655440002\"\n    },\n    \"error_context\": {\n      \"error_classification\": \"system_error\",\n      \"severity\": \"critical\",\n      \"recoverable\": true,\n      \"retry_recommended\": false,\n      \"escalation_required\": true,\n      \"recovery_actions\": [\n        \"Stop non-critical modules immediately\",\n        \"Clear system caches\",\n        \"Scale up infrastructure resources\",\n        \"Alert operations team for immediate intervention\"\n      ],\n      \"related_errors\": [],\n      \"system_impact\": \"system_wide\",\n      \"module_health_impact\": \"critical\"\n    }\n  },\n  \"observability\": {\n    \"trace_id\": \"system-critical-trace-001\",\n    \"span_id\": \"memory-exhaustion-error\",\n    \"error_fingerprint\": \"system_memory_critical_001\"\n  }\n}\n</code></pre>"},{"location":"eps/#error-handler-module-integration","title":"Error Handler Module Integration","text":""},{"location":"eps/#errorhandler-module-registration-mrs","title":"ErrorHandler Module Registration (MRS)","text":"<pre><code>{\n  \"module_identity\": {\n    \"module_name\": \"ErrorHandler_Core\",\n    \"module_class\": \"CentralizedErrorProcessor\",\n    \"module_type\": \"error_management_service\",\n    \"module_version\": \"1.0.0\",\n    \"description\": \"Centralized error processing, recovery management, and escalation handling\",\n    \"registration_timestamp\": \"2025-07-31T16:54:24.567Z\"\n  },\n  \"capability_declaration\": {\n    \"provides_events\": [\n      \"ERROR_PROCESSED\",\n      \"MODULE_RECOVERY_INITIATED\",\n      \"ERROR_ALERT_GENERATED\",\n      \"ERROR_STATISTICS_UPDATED\"\n    ],\n    \"consumes_events\": [\"EPS_ERROR_RESPONSE\"]\n  },\n  \"technical_requirements\": {\n    \"supported_protocols\": [\"rcs_v2\"],\n    \"resource_requirements\": {\n      \"min_memory_mb\": 512,\n      \"max_memory_mb\": 2048,\n      \"cpu_cores\": 2,\n      \"instance_count\": 1\n    }\n  }\n}\n</code></pre>"},{"location":"eps/#errorhandler-processing-workflow","title":"ErrorHandler Processing Workflow","text":"<pre><code>flowchart TD\n    E[EPS Error Received] --&gt; C[Classify Error]\n    C --&gt; S[Determine Severity]\n    S --&gt; R{Recoverable?}\n\n    R --&gt;|Yes| RA[Execute Recovery Actions]\n    R --&gt;|No| ES[Escalate Immediately]\n\n    RA --&gt; RT{Retry Recommended?}\n    RT --&gt;|Yes| SC[Schedule Retry]\n    RT --&gt;|No| Log[Log Error]\n\n    SC --&gt; Log\n    ES --&gt; Log\n    Log --&gt; A{Alert Required?}\n\n    A --&gt;|Yes| AL[Send Alert]\n    A --&gt;|No| ST[Update Statistics]\n\n    AL --&gt; ST\n    ST --&gt; End[Complete Processing]</code></pre>"},{"location":"eps/#minimal-required-error-message","title":"Minimal Required Error Message","text":"<p>The absolute minimum valid EPS error message:</p> <pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"550e8400-e29b-41d4-a716-446655440004\",\n    \"correlation_id\": \"unknown\",\n    \"parent_message_id\": \"unknown\",\n    \"created_at\": \"2025-07-31T16:54:24.678Z\",\n    \"priority\": \"medium\"\n  },\n  \"routing\": {\n    \"event_type\": \"EPS_ERROR_RESPONSE\",\n    \"event_category\": \"error_handling\",\n    \"source_module\": \"Mediator\",\n    \"original_source_module\": \"unknown\",\n    \"routing_tags\": [\"parse_error\"]\n  },\n  \"error_payload\": {\n    \"schema_version\": \"1.0\",\n    \"content_type\": \"application/json\",\n    \"size_bytes\": 156,\n    \"error_data\": {\n      \"jsonrpc\": \"2.0\",\n      \"error\": {\n        \"code\": -32700,\n        \"message\": \"Parse error\",\n        \"data\": {\n          \"reason\": \"Invalid JSON received\",\n          \"timestamp\": \"2025-07-31T16:54:24.678Z\"\n        }\n      },\n      \"id\": null\n    },\n    \"error_context\": {\n      \"error_classification\": \"protocol_error\",\n      \"severity\": \"medium\",\n      \"recoverable\": false,\n      \"retry_recommended\": false,\n      \"escalation_required\": false,\n      \"recovery_actions\": [\"Fix JSON format and resend\"],\n      \"system_impact\": \"single_request\",\n      \"module_health_impact\": \"none\"\n    }\n  },\n  \"observability\": {\n    \"trace_id\": \"parse-error-trace-001\",\n    \"span_id\": \"json-parse-failure\",\n    \"error_fingerprint\": \"json_parse_error_001\"\n  }\n}\n</code></pre>"},{"location":"eps/#implementation-guidelines","title":"Implementation Guidelines","text":""},{"location":"eps/#module-error-response-template","title":"Module Error Response Template","text":"<pre><code>abstract class RUNEModule {\n  protected generateEPSError(\n    originalMessage: RCSMessage | null,\n    errorCode: number,\n    errorMessage: string,\n    errorDetails: any = {},\n  ): EPSMessage {\n    return {\n      message_metadata: {\n        version: \"1.0\",\n        message_id: generateUUID(),\n        correlation_id:\n          originalMessage?.message_metadata?.correlation_id || \"unknown\",\n        parent_message_id:\n          originalMessage?.message_metadata?.message_id || \"unknown\",\n        created_at: new Date().toISOString(),\n        priority: this.determinePriority(errorCode),\n      },\n      routing: {\n        event_type: \"EPS_ERROR_RESPONSE\",\n        event_category: \"error_handling\",\n        source_module: this.moduleName,\n        target_module: \"ErrorHandler_Core\",\n        original_source_module:\n          originalMessage?.routing?.source_module || \"unknown\",\n        routing_tags: this.generateErrorTags(errorCode, errorDetails),\n      },\n      error_payload: {\n        schema_version: \"1.0\",\n        content_type: \"application/json\",\n        size_bytes: 0, // Calculate after serialization\n        error_data: {\n          jsonrpc: \"2.0\",\n          error: {\n            code: errorCode,\n            message: errorMessage,\n            data: {\n              reason: errorDetails.reason || errorMessage,\n              timestamp: new Date().toISOString(),\n              ...errorDetails,\n            },\n          },\n          id: originalMessage?.message_metadata?.message_id || null,\n        },\n        error_context: this.buildErrorContext(errorCode, errorDetails),\n      },\n      observability: {\n        trace_id: originalMessage?.observability?.trace_id || generateTraceId(),\n        span_id: generateSpanId(),\n        error_fingerprint: this.generateErrorFingerprint(\n          errorCode,\n          errorDetails,\n        ),\n      },\n    };\n  }\n}\n</code></pre>"},{"location":"eps/#error-classification-logic","title":"Error Classification Logic","text":"<pre><code>class ErrorClassifier {\n  static classifyError(errorCode: number): ErrorContext {\n    if (errorCode &gt;= -32099 &amp;&amp; errorCode &lt;= -32000) {\n      return { classification: \"protocol_error\", severity: \"medium\" };\n    } else if (errorCode &gt;= -32199 &amp;&amp; errorCode &lt;= -32100) {\n      return { classification: \"communication_error\", severity: \"high\" };\n    } else if (errorCode &gt;= -32299 &amp;&amp; errorCode &lt;= -32200) {\n      return { classification: \"validation_error\", severity: \"medium\" };\n    } else if (errorCode &gt;= -32399 &amp;&amp; errorCode &lt;= -32300) {\n      return { classification: \"security_error\", severity: \"high\" };\n    } else if (errorCode &gt;= -32499 &amp;&amp; errorCode &lt;= -32400) {\n      return { classification: \"system_error\", severity: \"critical\" };\n    } else if (errorCode &gt;= -32599 &amp;&amp; errorCode &lt;= -32500) {\n      return { classification: \"business_error\", severity: \"medium\" };\n    }\n    return { classification: \"unknown_error\", severity: \"medium\" };\n  }\n}\n</code></pre>"},{"location":"eps/#safety-mechanisms","title":"Safety Mechanisms","text":""},{"location":"eps/#infinite-loop-prevention","title":"Infinite Loop Prevention","text":"<ol> <li>ErrorHandler Isolation: ErrorHandler module cannot process its own errors</li> <li>Circuit Breaker: Maximum error processing rate per time window</li> <li>Fallback Logging: Critical errors logged directly if ErrorHandler unavailable</li> <li>Error Budget: Maximum errors per module before automatic intervention</li> </ol>"},{"location":"eps/#error-processing-limits","title":"Error Processing Limits","text":"<pre><code>{\n  \"error_safety_config\": {\n    \"max_errors_per_minute\": 100,\n    \"max_errors_per_module_per_minute\": 20,\n    \"circuit_breaker_threshold\": 50,\n    \"circuit_breaker_timeout_seconds\": 300,\n    \"fallback_logging_enabled\": true,\n    \"error_handler_isolation\": true\n  }\n}\n</code></pre>"},{"location":"eps/#critical-error-bypass","title":"Critical Error Bypass","text":"<pre><code>class Mediator {\n  handleCriticalError(error: Error, sourceModule: string) {\n    // SAFETY: Never route ErrorHandler's own errors back to ErrorHandler\n    if (sourceModule === \"ErrorHandler_Core\") {\n      this.logCriticalErrorDirectly(error);\n      this.triggerEmergencyProcedures(error);\n      return;\n    }\n\n    // SAFETY: Circuit breaker check\n    if (this.errorRateExceeded()) {\n      this.logCriticalErrorDirectly(error);\n      this.triggerCircuitBreaker();\n      return;\n    }\n\n    // Normal error processing\n    this.routeErrorToHandler(error, sourceModule);\n  }\n}\n</code></pre>"},{"location":"eps/#implementation-notes","title":"Implementation Notes","text":"<ol> <li>Timestamps: All timestamps must be in RFC 3339 format with UTC timezone</li> <li>UUIDs: Use UUID v4 for all identifier fields</li> <li>Error Fingerprinting: Create consistent fingerprints for error grouping and analysis</li> <li>Size Calculation: <code>size_bytes</code> must be calculated after JSON serialization</li> <li>Priority Mapping: Error code ranges automatically determine message priority</li> <li>Trace Continuity: Always preserve trace_id from original request for observability</li> <li>Recovery Actions: Provide specific, actionable recovery recommendations</li> <li>Classification Consistency: Use standard error classification types for proper routing</li> </ol> <p>This Error Protocol Specification ensures robust, consistent error handling across the RUNE platform while maintaining architectural principles of modularity, observability, and system stability.</p>"},{"location":"glossary/","title":"Glossary","text":"<p>Action A named capability that RUNE can execute on a node. In practice, an action maps to a plugin executable plus metadata in the registry.</p> <p>BPCS Bash Plugin Communication Specification. Defines the JSON contract for plugin stdin and stdout.</p> <p>CLI Command line interface used by operators and automation to request actions.</p> <p>EPS Error Protocol Specification. Defines the structured error envelope used by RUNE for failures that must propagate through the system.</p> <p>LOM Lifecycle Orchestration Module. Validates requests, applies policy, and owns registry and lifecycle.</p> <p>LMM Local Mediation Module. Routes and executes requests, selects transports, validates outputs, and normalizes errors.</p> <p>Module A logical component that provides a capability and communicates using RCS. Examples include LOM, LMM, ErrorHandler, and plugin capability providers.</p> <p>MRS Module Registration Specification. Defines how modules declare identity, capabilities, and operational metadata.</p> <p>Node A target system where an action runs. Typically a Linux host reachable by SSH or managed by SSM.</p> <p>Plugin An executable on the target node that implements an action. For Bash plugins, the plugin speaks BPCS and should use the shared library.</p> <p>RCS Runtime Communication Specification. Defines the runtime message envelope used between modules and for request correlation.</p> <p>Transport A mechanism used to execute plugins on a node, such as SSH or AWS SSM.</p> <p>Trace Identifiers (<code>trace_id</code>, <code>span_id</code>, correlation id) carried through messages to support observability and audit.</p>"},{"location":"install/","title":"Install","text":"<p>This page describes how to install and deploy RUNE in a corporate IT environment.</p> <p>RUNE has two installation surfaces:</p> <ul> <li>Local operator surface: the CLI and core modules (LOM and LMM)</li> <li>Remote execution surface: a plugin bundle on the target node</li> </ul>"},{"location":"install/#local-requirements","title":"Local requirements","text":"<ul> <li>Python 3.12 or newer (3.13 supported)</li> <li>Network access to target nodes (SSH) or to AWS APIs (SSM), depending on transport</li> <li>A way to provide credentials to the selected transport (SSH keys, SSM instance profile)</li> </ul>"},{"location":"install/#install-the-cli-developer-and-lightweight-deployments","title":"Install the CLI (developer and lightweight deployments)","text":"<pre><code>python -m pip install rune-framework\n</code></pre> <p>If you are using virtual environments:</p> <pre><code>python -m venv .venv\nsource .venv/bin/activate\npython -m pip install rune-framework\n</code></pre>"},{"location":"install/#remote-node-requirements","title":"Remote node requirements","text":"<p>RUNE does not require a daemon on the target node. It executes plugins using the selected transport.</p> <p>Typical requirements for Bash plugins:</p> <ul> <li><code>/bin/bash</code></li> <li><code>jq</code> (recommended for building JSON safely)</li> <li>permissions to perform the remediation actions</li> </ul>"},{"location":"install/#default-filesystem-conventions","title":"Default filesystem conventions","text":"<p>These paths are conventions used by the reference implementation:</p> <ul> <li>Plugins: <code>/opt/rune/plugins/</code></li> <li>Shared bash library: <code>/opt/rune/lib/rune_bpcs.sh</code></li> <li>Optional logs: <code>/var/log/rune/</code> (only if you choose to persist local plugin logs)</li> </ul> <p>You can change these via configuration, but standardizing paths helps operations and packaging.</p>"},{"location":"install/#plugin-bundle-distribution","title":"Plugin bundle distribution","text":"<p>In most environments, you will want a controlled way to ship plugins:</p> <ul> <li>internal package repository (RPM/DEB)</li> <li>golden image or AMI bake</li> <li>configuration management for file distribution only</li> <li>artifact sync from object storage</li> </ul> <p>RUNE itself does not mandate how you distribute plugins. It only requires that the plugin executable and any required shared libraries are present on the node.</p>"},{"location":"install/#enterprise-packaging","title":"Enterprise packaging","text":"<p>A common enterprise approach is:</p> <ul> <li>distribute the CLI as a Python package to operator workstations or automation runners</li> <li>distribute plugins as OS packages (RPM/DEB) owned by an internal team</li> </ul> <p>The protocol contracts allow this split without changing the runtime behavior.</p>"},{"location":"install/#configuration","title":"Configuration","text":"<p>RUNE configuration is designed for predictable operations:</p> <ul> <li>explicit transport configuration</li> <li>explicit plugin path configuration</li> <li>explicit timeouts and safety limits</li> </ul> <p>See Architecture for where configuration is applied, and Mediation Model for the control points the LMM enforces.</p>"},{"location":"json_appendix/","title":"JSON appendix","text":"<p>This appendix provides example messages for common RUNE flows.</p> <p>These are examples. They illustrate shape and intent. Field sets can be extended as needed, but the envelope sections should remain stable.</p>"},{"location":"json_appendix/#1-plugin-registration-mrs","title":"1. Plugin registration (MRS)","text":"<pre><code>{\n  \"module_identity\": {\n    \"module_name\": \"PluginBundle_CoreOps\",\n    \"module_class\": \"PluginProvider\",\n    \"module_type\": \"plugin_provider\",\n    \"module_version\": \"1.0.0\",\n    \"description\": \"Core operations plugin bundle\",\n    \"registration_timestamp\": \"2025-12-18T00:00:00Z\"\n  },\n  \"capability_declaration\": {\n    \"provides_events\": [\n      {\n        \"event_type\": \"ACTION.health_check\",\n        \"description\": \"Collect basic host health facts\",\n        \"schema_version\": \"1.0\",\n        \"backward_compatible\": true\n      }\n    ]\n  },\n  \"service_metadata\": {\n    \"owner_team\": \"Platform Operations\",\n    \"routing_hints\": {\n      \"plugin_path\": \"/opt/rune/plugins/health_check\",\n      \"default_transport\": \"ssh\",\n      \"timeout_ms\": 60000\n    }\n  }\n}\n</code></pre>"},{"location":"json_appendix/#2-action-execute-request-rcs","title":"2. Action execute request (RCS)","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"msg-001\",\n    \"correlation_id\": \"req-123\",\n    \"created_at\": \"2025-12-18T00:00:00Z\"\n  },\n  \"routing\": {\n    \"event_type\": \"ACTION_EXECUTE_REQUEST\",\n    \"event_category\": \"orchestration\",\n    \"source_module\": \"CLI\",\n    \"target_module\": \"LMM\",\n    \"routing_tags\": [\"action:health_check\"],\n    \"timeout_ms\": 60000\n  },\n  \"payload\": {\n    \"schema_version\": \"bpcs_v1\",\n    \"content_type\": \"application/json\",\n    \"encoding\": \"utf-8\",\n    \"data\": {\n      \"input_parameters\": {},\n      \"context\": { \"node\": \"myhost01\", \"triggered_by\": \"cli\" }\n    }\n  },\n  \"observability\": {\n    \"trace_id\": \"trace-abc-001\",\n    \"span_id\": \"span-cli-001\"\n  }\n}\n</code></pre>"},{"location":"json_appendix/#3-plugin-input-bpcs-stdin","title":"3. Plugin input (BPCS stdin)","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"bpcs-001\",\n    \"correlation_id\": \"req-123\",\n    \"created_at\": \"2025-12-18T00:00:01Z\"\n  },\n  \"payload\": {\n    \"input_parameters\": {},\n    \"context\": { \"node\": \"myhost01\", \"triggered_by\": \"cli\" }\n  },\n  \"observability\": {\n    \"trace_id\": \"trace-abc-001\",\n    \"span_id\": \"span-plugin-001\"\n  }\n}\n</code></pre>"},{"location":"json_appendix/#4-plugin-success-output-bpcs-stdout","title":"4. Plugin success output (BPCS stdout)","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"bpcs-001\",\n    \"correlation_id\": \"req-123\",\n    \"created_at\": \"2025-12-18T00:00:02Z\"\n  },\n  \"payload\": {\n    \"result\": \"success\",\n    \"output_data\": { \"uptime_seconds\": 12345, \"load_1m\": 0.12 }\n  },\n  \"observability\": {\n    \"trace_id\": \"trace-abc-001\",\n    \"span_id\": \"span-plugin-001\"\n  },\n  \"error\": null\n}\n</code></pre>"},{"location":"json_appendix/#5-plugin-failure-output-bpcs-stdout","title":"5. Plugin failure output (BPCS stdout)","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"bpcs-001\",\n    \"correlation_id\": \"req-123\",\n    \"created_at\": \"2025-12-18T00:00:02Z\"\n  },\n  \"payload\": null,\n  \"observability\": {\n    \"trace_id\": \"trace-abc-001\",\n    \"span_id\": \"span-plugin-001\"\n  },\n  \"error\": {\n    \"code\": 2,\n    \"message\": \"Dependency missing\",\n    \"details\": { \"binary\": \"systemctl\" }\n  }\n}\n</code></pre>"},{"location":"json_appendix/#6-platform-normalized-error-eps","title":"6. Platform normalized error (EPS)","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"eps-001\",\n    \"correlation_id\": \"req-123\",\n    \"created_at\": \"2025-12-18T00:00:02Z\",\n    \"priority\": \"high\"\n  },\n  \"routing\": {\n    \"event_type\": \"EPS_ERROR_RESPONSE\",\n    \"event_category\": \"error_handling\",\n    \"source_module\": \"LMM\",\n    \"target_module\": \"ErrorHandler_Core\",\n    \"routing_tags\": [\"plugin_failure\"]\n  },\n  \"error_payload\": {\n    \"error_data\": {\n      \"error_code\": 32010,\n      \"error_type\": \"PLUGIN_FAILURE\",\n      \"error_message\": \"Plugin reported an error\",\n      \"severity\": \"error\",\n      \"recoverable\": true,\n      \"details\": {\n        \"plugin_error_code\": 2,\n        \"plugin_error_message\": \"Dependency missing\",\n        \"node\": \"myhost01\",\n        \"action\": \"health_check\"\n      }\n    },\n    \"error_context\": {\n      \"origin_module\": \"LMM\",\n      \"timestamp\": \"2025-12-18T00:00:02Z\",\n      \"recovery_actions\": [\n        \"Install missing dependency on the node\",\n        \"Verify plugin prerequisites and packaging\"\n      ],\n      \"system_impact\": \"single_request\"\n    }\n  },\n  \"observability\": {\n    \"trace_id\": \"trace-abc-001\",\n    \"span_id\": \"span-lmm-001\",\n    \"error_fingerprint\": \"plugin_dependency_missing_001\"\n  }\n}\n</code></pre>"},{"location":"lifecycle/","title":"Lifecycle model","text":"<p>The Lifecycle Orchestration Module (LOM) is responsible for owning and coordinating the runtime lifecycle of RUNE modules and capabilities.</p> <p>In early builds, modules may be implemented as in process components. The lifecycle model still applies because it defines responsibilities, not process topology.</p>"},{"location":"lifecycle/#what-lom-owns","title":"What LOM owns","text":"<ul> <li>action and module registry (built from MRS declarations or static equivalents)</li> <li>startup and shutdown ordering for core components</li> <li>request validation and execution planning</li> <li>policy decisions that should not live in plugins (timeouts, retries, safety flags)</li> <li>correlation and trace identifier creation</li> </ul>"},{"location":"lifecycle/#registration-and-discovery","title":"Registration and discovery","text":"<p>RUNE uses the Module Registration Specification (MRS) to represent capabilities. In the RUNE profile:</p> <ul> <li>core modules (LOM, LMM, ErrorHandler) register as modules</li> <li>plugins register as capabilities of a plugin module</li> </ul> <p>For deployments that do not want dynamic registration, the same schema can be produced from a static catalog file at startup. This keeps the contract stable while allowing controlled operations.</p>"},{"location":"lifecycle/#lifecycle-states","title":"Lifecycle states","text":"<p>A module or plugin capability typically moves through:</p> <ol> <li>discovered: known to the registry</li> <li>available: dependencies satisfied and eligible for use</li> <li>active: currently in use or running heartbeats</li> <li>degraded: reachable but failing health checks</li> <li>unavailable: not eligible for routing</li> </ol> <p>These states are used for routing decisions, operator feedback, and error handling.</p>"},{"location":"lifecycle/#action-execution-lifecycle","title":"Action execution lifecycle","text":"<p>At a high level:</p> <ol> <li>CLI request arrives.</li> <li>LOM validates request parameters and selects a registry entry.</li> <li>LOM emits an RCS action execution request to the LMM.</li> <li>LMM executes and returns a result or EPS failure.</li> <li>LOM returns a final response to the CLI.</li> </ol>"},{"location":"lifecycle/#operational-controls","title":"Operational controls","text":"<p>In corporate environments, lifecycle is about control:</p> <ul> <li>a change window can restrict which actions are allowed</li> <li>a maintenance mode can disable remediation actions while still allowing diagnostics</li> <li>a break glass policy can require explicit operator acknowledgment for high impact actions</li> </ul> <p>These controls belong in LOM policy and registry metadata, not in plugins.</p>"},{"location":"mediation_model/","title":"Mediation model","text":"<p>RUNE enforces a mediation boundary to keep plugin execution safe, consistent, and auditable.</p> <p>The Local Mediation Module (LMM) is the only component that:</p> <ul> <li>executes plugins</li> <li>selects and configures transports</li> <li>interprets plugin output and exit codes</li> <li>normalizes failures into EPS</li> </ul> <p>This prevents ad hoc behavior from leaking into the rest of the system.</p>"},{"location":"mediation_model/#mediation-rules","title":"Mediation rules","text":""},{"location":"mediation_model/#no-direct-module-to-module-calls","title":"No direct module to module calls","text":"<p>Modules communicate using RCS messages routed through the LMM. Even when modules run in the same process, the contract is treated as if it were distributed.</p>"},{"location":"mediation_model/#plugins-do-not-talk-to-the-framework","title":"Plugins do not talk to the framework","text":"<p>Plugins communicate only via BPCS stdin and stdout. Plugins do not:</p> <ul> <li>emit RCS directly</li> <li>emit EPS directly</li> <li>reach into core state</li> <li>decide routing targets</li> </ul>"},{"location":"mediation_model/#registry-driven-routing","title":"Registry driven routing","text":"<p>The LMM routes requests using the registry built from MRS data. For plugins, the registry entry includes:</p> <ul> <li>action name</li> <li>plugin path and execution profile</li> <li>required parameters and validation hints</li> <li>preferred transport (optional)</li> <li>timeouts and retry policy (optional)</li> </ul> <p>This allows policy and routing to be centralized.</p>"},{"location":"mediation_model/#transport-selection","title":"Transport selection","text":"<p>The LMM selects transport based on:</p> <ul> <li>runtime configuration (what transports are enabled)</li> <li>node metadata (for example, SSM managed vs SSH only)</li> <li>action metadata (for example, action requires local execution)</li> </ul> <p>Transport selection is a mediation concern. LOM and plugins should not contain transport specific logic.</p>"},{"location":"mediation_model/#output-validation-and-normalization","title":"Output validation and normalization","text":"<p>The LMM treats plugin output as untrusted input. It:</p> <ul> <li>requires exactly one JSON object on stdout</li> <li>validates it against the BPCS expectations</li> <li>captures stderr separately as diagnostics</li> <li>interprets exit codes and error payloads</li> <li>emits EPS for failures that must propagate beyond the plugin boundary</li> </ul> <p>This makes the system predictable for both humans and automation.</p>"},{"location":"mediation_model/#observability","title":"Observability","text":"<p>The LMM propagates identifiers:</p> <ul> <li><code>correlation_id</code> connects a CLI request to downstream actions</li> <li><code>trace_id</code> and <code>span_id</code> support distributed tracing style correlation</li> <li><code>message_id</code> and <code>parent_message_id</code> provide message lineage</li> </ul> <p>These fields exist in the protocols so corporate logging and tracing systems can consume them without bespoke parsing.</p>"},{"location":"mrs/","title":"Module Registration Specification (MRS)","text":"<p>This is the canonical module and capability registration specification used by RUNE to build a registry for routing, discovery, and policy.</p> <p>For operational context, see Lifecycle model.</p>"},{"location":"mrs/#overview","title":"Overview","text":"<p>This document defines the standardized data format for module registration and capability declaration within the RUNE platform. This format enables dynamic module discovery and eliminates hardcoded assumptions about module capabilities.</p> <p>Unlike the Runtime Communication Specification (RCS) which prioritizes lightweight messaging for high-frequency operations, the MRS is designed for comprehensive capability declaration during module startup and topology changes. For error handling and recovery messaging, see the Error Protocol Specification (EPS).</p> <p>Key Principles:</p> <ul> <li>Dynamic Discovery: Zero hardcoded module types or capabilities</li> <li>Self-Description: Modules completely define their own identity and services</li> <li>Schema Declaration: Event types include full schema definitions</li> <li>Separation of Concerns: Registration data separate from runtime messaging</li> </ul>"},{"location":"mrs/#protocol-architecture-context","title":"Protocol Architecture Context","text":"<p>The RUNE platform operates on a three-protocol architecture that ensures separation of concerns and optimal performance:</p> Protocol Purpose Managed By Frequency Use Case MRS Module registration and capability declaration Orchestrator Low (startup/shutdown) Module lifecycle management RCS Runtime operational communication Mediator High (continuous) Normal module-to-module messaging EPS Error handling and recovery messaging Mediator + ErrorHandler Variable (exception-based) Error responses and recovery <p>Architecture Integration:</p> <ul> <li>Orchestrator: Maintains module registry built from MRS registrations</li> <li>Mediator: Uses Orchestrator's registry for RCS message routing decisions</li> <li>ErrorHandler: Processes EPS messages for registration errors and recovery</li> </ul> <p>Communication Flow:</p> <pre><code>flowchart TD\n    M[Module] --&gt;|MRS Registration| O[Orchestrator]\n    O --&gt;|Updates Registry| O\n    O --&gt;|Registry Data| ME[Mediator]\n    M --&gt;|RCS Messages| ME\n    ME --&gt;|Routes Using Registry| M2[Other Modules]\n    ME --&gt;|Registration Errors| EPS{EPS Format}\n    EPS --&gt;|Error Processing| EH[ErrorHandler]</code></pre>"},{"location":"mrs/#when-to-use-this-specification","title":"When to Use This Specification","text":"Use Case Specification Purpose Module Registration MRS Declaring module capabilities and subscribing to events Capability Updates MRS Updating module event schemas or dependencies Module Deregistration MRS Graceful shutdown and capability removal Registration Errors EPS Registration validation failures, dependency errors Module-to-Module Communication RCS Runtime operational messaging between registered modules Request-Response Patterns RCS Synchronous and asynchronous communication workflows Event Publishing/Subscribing RCS Broadcasting events to interested modules Health Check Responses RCS Responding to orchestrator health checks <p>Decision Rule: Use MRS only for registration and capability management. Use RCS for all operational communication after modules are registered. Use EPS for all error conditions during registration or runtime.</p> <p>Cross-Protocol References:</p> <ul> <li>See Runtime Communication Specification (RCS) for operational messaging</li> <li>See Error Protocol Specification (EPS) for error handling and recovery messaging</li> </ul>"},{"location":"mrs/#registration-message-structure","title":"Registration Message Structure","text":""},{"location":"mrs/#complete-format-example","title":"Complete Format Example","text":"<pre><code>{\n  \"module_identity\": {\n    \"module_name\": \"EmailAlerter_Primary\",\n    \"module_class\": \"EmailNotificationService\",\n    \"module_type\": \"alerting_service\",\n    \"module_version\": \"2.1.3\",\n    \"description\": \"Advanced email notification service with templating and retry logic\",\n    \"registration_timestamp\": \"2025-07-31T17:47:53.123Z\"\n  },\n  \"capability_declaration\": {\n    \"provides_events\": [\n      {\n        \"event_type\": \"EMAIL_SENT\",\n        \"description\": \"Published when email is successfully delivered\",\n        \"data_schema\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"message_id\": { \"type\": \"string\" },\n            \"recipient\": { \"type\": \"string\", \"format\": \"email\" },\n            \"subject\": { \"type\": \"string\" },\n            \"delivery_timestamp\": { \"type\": \"string\", \"format\": \"date-time\" },\n            \"smtp_response\": { \"type\": \"string\" }\n          },\n          \"required\": [\"message_id\", \"recipient\", \"delivery_timestamp\"]\n        },\n        \"example_data\": {\n          \"message_id\": \"msg_550e8400e29b41d4\",\n          \"recipient\": \"admin@example.com\",\n          \"subject\": \"System Alert: High CPU Usage\",\n          \"delivery_timestamp\": \"2025-07-31T17:47:53.456Z\",\n          \"smtp_response\": \"250 2.0.0 Ok: queued as 12345\"\n        },\n        \"schema_version\": \"1.2\",\n        \"backward_compatible\": true\n      },\n      {\n        \"event_type\": \"EMAIL_DELIVERY_FAILED\",\n        \"description\": \"Published when email delivery fails after all retries\",\n        \"data_schema\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"message_id\": { \"type\": \"string\" },\n            \"recipient\": { \"type\": \"string\", \"format\": \"email\" },\n            \"error_code\": { \"type\": \"string\" },\n            \"error_message\": { \"type\": \"string\" },\n            \"retry_count\": { \"type\": \"integer\" },\n            \"final_attempt_timestamp\": {\n              \"type\": \"string\",\n              \"format\": \"date-time\"\n            }\n          },\n          \"required\": [\"message_id\", \"recipient\", \"error_code\", \"retry_count\"]\n        },\n        \"example_data\": {\n          \"message_id\": \"msg_550e8400e29b41d4\",\n          \"recipient\": \"invalid@nonexistent.com\",\n          \"error_code\": \"550\",\n          \"error_message\": \"Recipient address rejected: User unknown\",\n          \"retry_count\": 3,\n          \"final_attempt_timestamp\": \"2025-07-31T17:50:53.789Z\"\n        },\n        \"schema_version\": \"1.1\",\n        \"backward_compatible\": true\n      }\n    ],\n    \"consumes_events\": [\n      \"SEND_EMAIL\",\n      \"SEND_NOTIFICATION\",\n      \"RENDER_EMAIL_TEMPLATE\"\n    ],\n    \"service_metadata\": {\n      \"smtp_server\": \"smtp.company.com\",\n      \"max_concurrent_sends\": 10,\n      \"retry_attempts\": 3,\n      \"supported_formats\": [\"text\", \"html\", \"multipart\"],\n      \"template_engine\": \"jinja2\",\n      \"authentication_method\": \"oauth2\",\n      \"encryption_support\": [\"tls\", \"ssl\"],\n      \"rate_limit_per_hour\": 1000\n    }\n  },\n  \"technical_requirements\": {\n    \"supported_protocols\": [\"rcs_v2\"],\n    \"dependencies\": [\n      {\n        \"module_name\": \"ConfigurationManager\",\n        \"version_requirement\": \"&gt;=2.0.0\",\n        \"criticality\": \"required\"\n      },\n      {\n        \"module_name\": \"LoggingModule\",\n        \"version_requirement\": \"&gt;=1.5.0\",\n        \"criticality\": \"optional\"\n      }\n    ],\n    \"resource_requirements\": {\n      \"min_memory_mb\": 256,\n      \"max_memory_mb\": 1024,\n      \"cpu_cores\": 2,\n      \"disk_space_mb\": 100,\n      \"network_bandwidth_mbps\": 10,\n      \"instance_count\": 1\n    },\n    \"health_check_endpoint\": {\n      \"event_type\": \"EMAIL_SERVICE_HEALTH_CHECK\",\n      \"expected_response\": \"EMAIL_SERVICE_HEALTH_RESPONSE\",\n      \"timeout_ms\": 5000,\n      \"check_interval_seconds\": 30\n    },\n    \"configuration_schema\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"smtp_host\": { \"type\": \"string\" },\n        \"smtp_port\": { \"type\": \"integer\", \"minimum\": 1, \"maximum\": 65535 },\n        \"username\": { \"type\": \"string\" },\n        \"password\": { \"type\": \"string\" },\n        \"from_address\": { \"type\": \"string\", \"format\": \"email\" }\n      },\n      \"required\": [\"smtp_host\", \"smtp_port\", \"from_address\"]\n    }\n  },\n  \"registration_metadata\": {\n    \"registration_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"registration_version\": \"1.0\",\n    \"expires_at\": \"2025-07-31T18:47:53.123Z\",\n    \"update_mode\": \"replace\",\n    \"registration_source\": \"module_startup\",\n    \"previous_registration_id\": null,\n    \"orchestrator_acknowledgment_required\": true\n  }\n}\n</code></pre>"},{"location":"mrs/#field-specifications","title":"Field Specifications","text":""},{"location":"mrs/#module-identity-section","title":"Module Identity Section","text":"Field Type Required Purpose <code>module_name</code> String Yes Unique identifier for this module instance <code>module_class</code> String Yes Module implementation class (e.g., \"EmailNotificationService\") <code>module_type</code> String Yes Functional category (e.g., \"alerting_service\") <code>module_version</code> String Yes Semantic version of the module implementation <code>description</code> String Yes Human-readable description of module capabilities <code>registration_timestamp</code> RFC 3339 String Yes When this registration was created in UTC (YYYY-MM-DDTHH:MM:SS.sssZ)"},{"location":"mrs/#capability-declaration-section","title":"Capability Declaration Section","text":"Field Type Required Purpose <code>provides_events</code> Array[Object] Yes Complete list of events this module can publish <code>consumes_events</code> Array[String] Yes List of event types this module subscribes to <code>service_metadata</code> Object No Module-specific capabilities and configuration information"},{"location":"mrs/#event-definition-object-within-provides_events","title":"Event Definition Object (within <code>provides_events</code>)","text":"Field Type Required Purpose <code>event_type</code> String Yes Unique identifier for this event type <code>description</code> String Yes Human-readable description of when this event is published <code>data_schema</code> Object Yes JSON Schema definition for the event payload <code>example_data</code> Object No Sample payload demonstrating the schema <code>schema_version</code> String Yes Version of this event's schema for evolution tracking <code>backward_compatible</code> Boolean No Whether this version maintains backward compatibility <p>Event Type Naming Convention:</p> <ul> <li>Use past tense for completed actions: <code>EMAIL_SENT</code>, <code>DATA_PROCESSED</code>, <code>USER_AUTHENTICATED</code></li> <li>Use present tense for commands/requests: <code>SEND_EMAIL</code>, <code>PROCESS_DATA</code>, <code>AUTHENTICATE_USER</code></li> <li>Use noun phrases for status: <code>SYSTEM_STATUS</code>, <code>HEALTH_CHECK</code></li> </ul>"},{"location":"mrs/#technical-requirements-section","title":"Technical Requirements Section","text":"Field Type Required Purpose <code>supported_protocols</code> Array[String] Yes Communication protocols this module supports (e.g., \"rcs_v2\") <code>dependencies</code> Array[Object] No Other modules this module requires to function <code>resource_requirements</code> Object No Hardware and resource needs for this module <code>health_check_endpoint</code> Object No How the orchestrator can verify module health <code>configuration_schema</code> Object No JSON Schema for module configuration requirements"},{"location":"mrs/#dependency-object","title":"Dependency Object","text":"Field Type Required Purpose <code>module_name</code> String Yes Name of the required module <code>version_requirement</code> String No Semantic version requirement (e.g., \"&gt;=2.0.0\") <code>criticality</code> Enum String Yes \"required\" or \"optional\""},{"location":"mrs/#resource-requirements-object","title":"Resource Requirements Object","text":"Field Type Required Purpose <code>min_memory_mb</code> Integer No Minimum memory requirement in megabytes <code>max_memory_mb</code> Integer No Maximum memory usage in megabytes <code>cpu_cores</code> Integer No Number of CPU cores needed <code>disk_space_mb</code> Integer No Persistent storage requirement in MB <code>network_bandwidth_mbps</code> Integer No Network bandwidth requirement in Mbps <code>instance_count</code> Integer No Number of module instances (default: 1)"},{"location":"mrs/#health-check-endpoint-object","title":"Health Check Endpoint Object","text":"Field Type Required Purpose <code>event_type</code> String Yes Event to send for health check <code>expected_response</code> String Yes Expected response event type <code>timeout_ms</code> Integer Yes Timeout for health check response <code>check_interval_seconds</code> Integer No Recommended interval between health checks"},{"location":"mrs/#registration-metadata-section","title":"Registration Metadata Section","text":"Field Type Required Purpose <code>registration_id</code> UUID String Yes Unique identifier for this registration <code>registration_version</code> String Yes Version of the MRS protocol used (current: \"1.0\") <code>expires_at</code> RFC 3339 String No When this registration expires and needs renewal (default: 1 hour) <code>update_mode</code> Enum String Yes How to handle updates: <code>replace</code>, <code>merge</code>, <code>append</code> <code>registration_source</code> String No What triggered this registration: <code>module_startup</code>, <code>capability_update</code> <code>previous_registration_id</code> UUID String No Links to previous registration if this is an update <code>orchestrator_acknowledgment_required</code> Boolean No Whether module needs confirmation of successful registration (default: true)"},{"location":"mrs/#event-schema-definition-format","title":"Event Schema Definition Format","text":"<p>All events declared in <code>provides_events</code> must follow this standardized schema definition format:</p> <pre><code>{\n  \"event_type\": \"CUSTOM_EVENT_NAME\",\n  \"description\": \"Clear description of when and why this event is published\",\n  \"data_schema\": {\n    \"type\": \"object\",\n    \"properties\": {\n      \"field_name\": {\n        \"type\": \"string|number|boolean|object|array\",\n        \"description\": \"Purpose of this field\",\n        \"format\": \"email|date-time|uri|etc\",\n        \"minimum\": 0,\n        \"maximum\": 100,\n        \"enum\": [\"option1\", \"option2\"]\n      }\n    },\n    \"required\": [\"field1\", \"field2\"],\n    \"additionalProperties\": false\n  },\n  \"example_data\": {\n    \"field_name\": \"example_value\"\n  },\n  \"schema_version\": \"1.0\",\n  \"backward_compatible\": true\n}\n</code></pre> <p>Schema Definition Requirements:</p> <ul> <li>Use JSON Schema Draft 7 format</li> <li>Include <code>description</code> for all fields</li> <li>Specify <code>required</code> fields array</li> <li>Provide realistic <code>example_data</code></li> <li>Use semantic versioning for <code>schema_version</code></li> </ul>"},{"location":"mrs/#registration-protocol-events","title":"Registration Protocol Events","text":"<p>The registration process uses these standardized event types:</p>"},{"location":"mrs/#module_registration_request","title":"MODULE_REGISTRATION_REQUEST","text":"<p>Sent by modules to register their capabilities with the orchestrator.</p> <p>Payload Schema:</p> <pre><code>{\n  \"type\": \"object\",\n  \"properties\": {\n    \"registration_data\": {\n      \"type\": \"object\",\n      \"description\": \"Complete module registration as defined in this specification\"\n    }\n  },\n  \"required\": [\"registration_data\"]\n}\n</code></pre>"},{"location":"mrs/#module_registration_response","title":"MODULE_REGISTRATION_RESPONSE","text":"<p>Sent by orchestrator to acknowledge successful registration or report errors.</p> <p>Payload Schema:</p> <pre><code>{\n  \"type\": \"object\",\n  \"properties\": {\n    \"status\": { \"type\": \"string\", \"enum\": [\"success\", \"error\"] },\n    \"registration_id\": { \"type\": \"string\" },\n    \"message\": { \"type\": \"string\" },\n    \"assigned_routing_tags\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } },\n    \"validation_errors\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n  },\n  \"required\": [\"status\", \"registration_id\", \"message\"]\n}\n</code></pre>"},{"location":"mrs/#module_registration_update","title":"MODULE_REGISTRATION_UPDATE","text":"<p>Sent by modules to update their capabilities without full re-registration.</p> <p>Payload Schema:</p> <pre><code>{\n  \"type\": \"object\",\n  \"properties\": {\n    \"registration_id\": { \"type\": \"string\" },\n    \"update_type\": {\n      \"type\": \"string\",\n      \"enum\": [\"add_events\", \"remove_events\", \"update_metadata\"]\n    },\n    \"changes\": { \"type\": \"object\" }\n  },\n  \"required\": [\"registration_id\", \"update_type\", \"changes\"]\n}\n</code></pre>"},{"location":"mrs/#module_deregistration","title":"MODULE_DEREGISTRATION","text":"<p>Sent by modules when shutting down or by orchestrator to remove failed modules.</p> <p>Payload Schema:</p> <pre><code>{\n  \"type\": \"object\",\n  \"properties\": {\n    \"registration_id\": { \"type\": \"string\" },\n    \"module_name\": { \"type\": \"string\" },\n    \"reason\": { \"type\": \"string\" },\n    \"graceful_shutdown\": { \"type\": \"boolean\" }\n  },\n  \"required\": [\"registration_id\", \"module_name\", \"reason\"]\n}\n</code></pre>"},{"location":"mrs/#registration_heartbeat","title":"REGISTRATION_HEARTBEAT","text":"<p>Periodic signal to maintain registration and report health status.</p> <p>Payload Schema:</p> <pre><code>{\n  \"type\": \"object\",\n  \"properties\": {\n    \"registration_id\": { \"type\": \"string\" },\n    \"module_name\": { \"type\": \"string\" },\n    \"health_status\": {\n      \"type\": \"string\",\n      \"enum\": [\"healthy\", \"degraded\", \"critical\"]\n    },\n    \"performance_metrics\": { \"type\": \"object\" },\n    \"last_activity_timestamp\": { \"type\": \"string\", \"format\": \"date-time\" }\n  },\n  \"required\": [\"registration_id\", \"module_name\", \"health_status\"]\n}\n</code></pre>"},{"location":"mrs/#error-handling","title":"Error Handling","text":"<p>Important Note: MRS does not define error message formats. All error responses during registration use the Error Protocol Specification (EPS) format.</p> <p>When MRS registration processing encounters errors, the response follows EPS format instead of MRS format. Common registration error scenarios include:</p>"},{"location":"mrs/#when-eps-is-used-instead-of-mrs","title":"When EPS is Used Instead of MRS","text":"Error Condition Protocol Used Handling Component Registration JSON parse failure EPS Orchestrator Schema validation failure EPS Orchestrator Duplicate module name EPS Orchestrator Dependency not found EPS Orchestrator Resource requirements exceeded EPS Orchestrator Event type conflict EPS Orchestrator"},{"location":"mrs/#registration-error-flow","title":"Registration Error Flow","text":"<pre><code>flowchart TD\n    M[Module] --&gt;|MRS Registration| O[Orchestrator]\n    O --&gt;|Validation Error| EPS{Generate EPS Error}\n    O --&gt;|Valid Registration| REG[Update Registry]\n    EPS --&gt;|EPS Format| EH[ErrorHandler]\n    EH --&gt;|Registration Failed| M\n    REG --&gt;|Success Response| M</code></pre>"},{"location":"mrs/#common-registration-error-codes","title":"Common Registration Error Codes","text":"EPS Error Code MRS Context Description -32200 Schema validation failed Event schema doesn't comply with JSON Schema Draft 7 -32201 Required field missing Missing required MRS fields -32202 Field type mismatch Invalid data types in registration -32203 Field value out of range Resource requirements exceed limits -32204 Invalid field format Malformed module name or version -32205 Duplicate module name Module name already registered -32206 Dependency not found Required dependency module not available -32207 Version conflict Module version conflicts with existing registration -32208 Event type conflict Event type already published by another module <p>For complete error handling specifications, see: Error Protocol Specification (EPS)</p>"},{"location":"mrs/#registration-lifecycle","title":"Registration Lifecycle","text":"<p>Module registrations follow a configurable lifecycle pattern:</p>"},{"location":"mrs/#default-lifecycle-settings","title":"Default Lifecycle Settings","text":"<ul> <li>Registration Expiry: 1 hour (3600 seconds) from registration timestamp</li> <li>Heartbeat Interval: Every 30 minutes (1800 seconds)</li> <li>Grace Period: 5 minutes after expiry before forced deregistration</li> </ul>"},{"location":"mrs/#lifecycle-events","title":"Lifecycle Events","text":"<ol> <li>Initial Registration: Module sends <code>MODULE_REGISTRATION_REQUEST</code></li> <li>Acknowledgment: Orchestrator responds with <code>MODULE_REGISTRATION_RESPONSE</code></li> <li>Periodic Heartbeats: Module sends <code>REGISTRATION_HEARTBEAT</code> every 30 minutes</li> <li>Registration Renewal: Automatic renewal on heartbeat or manual renewal</li> <li>Graceful Deregistration: Module sends <code>MODULE_DEREGISTRATION</code> on shutdown</li> <li>Forced Deregistration: Orchestrator removes unresponsive modules</li> </ol>"},{"location":"mrs/#configuration-override","title":"Configuration Override","text":"<p>External configuration can modify these defaults:</p> <pre><code>{\n  \"registration_lifecycle\": {\n    \"default_expiry_seconds\": 3600,\n    \"heartbeat_interval_seconds\": 1800,\n    \"grace_period_seconds\": 300,\n    \"max_missed_heartbeats\": 2\n  }\n}\n</code></pre>"},{"location":"mrs/#minimal-required-registration","title":"Minimal Required Registration","text":"<p>The absolute minimum valid registration contains only required fields:</p> <pre><code>{\n  \"module_identity\": {\n    \"module_name\": \"SimpleLogger\",\n    \"module_class\": \"BasicFileLogger\",\n    \"module_type\": \"logging_service\",\n    \"module_version\": \"1.0.0\",\n    \"description\": \"Basic file-based logging service\",\n    \"registration_timestamp\": \"2025-07-31T17:47:53.123Z\"\n  },\n  \"capability_declaration\": {\n    \"provides_events\": [\n      {\n        \"event_type\": \"LOG_WRITTEN\",\n        \"description\": \"Published when log entry is written to file\",\n        \"data_schema\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"log_level\": { \"type\": \"string\" },\n            \"message\": { \"type\": \"string\" },\n            \"timestamp\": { \"type\": \"string\", \"format\": \"date-time\" }\n          },\n          \"required\": [\"log_level\", \"message\", \"timestamp\"]\n        },\n        \"schema_version\": \"1.0\"\n      }\n    ],\n    \"consumes_events\": [\"LOG_MESSAGE\"]\n  },\n  \"technical_requirements\": {\n    \"supported_protocols\": [\"rcs_v2\"]\n  },\n  \"registration_metadata\": {\n    \"registration_id\": \"550e8400-e29b-41d4-a716-446655440001\",\n    \"registration_version\": \"1.0\",\n    \"update_mode\": \"replace\"\n  }\n}\n</code></pre>"},{"location":"mrs/#example-implementations","title":"Example Implementations","text":""},{"location":"mrs/#emailalerter-module-registration","title":"EmailAlerter Module Registration","text":"<pre><code>{\n  \"module_identity\": {\n    \"module_name\": \"EmailAlerter_Production\",\n    \"module_class\": \"EnterpriseEmailService\",\n    \"module_type\": \"alerting_service\",\n    \"module_version\": \"3.2.1\",\n    \"description\": \"Enterprise-grade email alerting with templates, batching, and advanced routing\",\n    \"registration_timestamp\": \"2025-07-31T17:47:53.123Z\"\n  },\n  \"capability_declaration\": {\n    \"provides_events\": [\n      {\n        \"event_type\": \"EMAIL_BATCH_SENT\",\n        \"description\": \"Published when a batch of emails is successfully sent\",\n        \"data_schema\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"batch_id\": { \"type\": \"string\" },\n            \"email_count\": { \"type\": \"integer\", \"minimum\": 1 },\n            \"recipients\": {\n              \"type\": \"array\",\n              \"items\": { \"type\": \"string\", \"format\": \"email\" }\n            },\n            \"template_used\": { \"type\": \"string\" },\n            \"send_duration_ms\": { \"type\": \"integer\" },\n            \"success_count\": { \"type\": \"integer\" },\n            \"failure_count\": { \"type\": \"integer\" }\n          },\n          \"required\": [\n            \"batch_id\",\n            \"email_count\",\n            \"success_count\",\n            \"failure_count\"\n          ]\n        },\n        \"schema_version\": \"2.1\",\n        \"backward_compatible\": false\n      },\n      {\n        \"event_type\": \"EMAIL_TEMPLATE_RENDERED\",\n        \"description\": \"Published when email template is successfully rendered with data\",\n        \"data_schema\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"template_id\": { \"type\": \"string\" },\n            \"rendered_subject\": { \"type\": \"string\" },\n            \"rendered_body\": { \"type\": \"string\" },\n            \"data_variables\": { \"type\": \"object\" },\n            \"render_time_ms\": { \"type\": \"integer\" }\n          },\n          \"required\": [\"template_id\", \"rendered_subject\", \"rendered_body\"]\n        },\n        \"schema_version\": \"1.0\",\n        \"backward_compatible\": true\n      }\n    ],\n    \"consumes_events\": [\n      \"SEND_EMAIL\",\n      \"SEND_BATCH_NOTIFICATION\",\n      \"RENDER_EMAIL_TEMPLATE\",\n      \"UPDATE_EMAIL_CONFIG\"\n    ],\n    \"service_metadata\": {\n      \"max_batch_size\": 100,\n      \"template_formats\": [\"html\", \"text\", \"markdown\"],\n      \"supported_attachments\": [\"pdf\", \"txt\", \"jpg\", \"png\"],\n      \"rate_limits\": {\n        \"emails_per_minute\": 500,\n        \"emails_per_hour\": 10000\n      },\n      \"smtp_pools\": [\"primary\", \"backup\", \"bulk\"],\n      \"encryption_methods\": [\"tls_1_2\", \"tls_1_3\"],\n      \"bounce_handling\": true,\n      \"delivery_tracking\": true\n    }\n  },\n  \"technical_requirements\": {\n    \"supported_protocols\": [\"rcs_v2\"],\n    \"dependencies\": [\n      {\n        \"module_name\": \"ConfigurationManager\",\n        \"version_requirement\": \"&gt;=3.0.0\",\n        \"criticality\": \"required\"\n      },\n      {\n        \"module_name\": \"TemplateEngine\",\n        \"version_requirement\": \"&gt;=2.1.0\",\n        \"criticality\": \"required\"\n      },\n      {\n        \"module_name\": \"LoggingModule\",\n        \"version_requirement\": \"&gt;=1.8.0\",\n        \"criticality\": \"optional\"\n      }\n    ],\n    \"resource_requirements\": {\n      \"min_memory_mb\": 512,\n      \"max_memory_mb\": 2048,\n      \"cpu_cores\": 4,\n      \"disk_space_mb\": 500,\n      \"network_bandwidth_mbps\": 50,\n      \"instance_count\": 1\n    },\n    \"health_check_endpoint\": {\n      \"event_type\": \"EMAIL_SERVICE_PING\",\n      \"expected_response\": \"EMAIL_SERVICE_PONG\",\n      \"timeout_ms\": 3000,\n      \"check_interval_seconds\": 60\n    }\n  },\n  \"registration_metadata\": {\n    \"registration_id\": \"550e8400-e29b-41d4-a716-446655440100\",\n    \"registration_version\": \"1.0\",\n    \"update_mode\": \"replace\",\n    \"registration_source\": \"module_startup\"\n  }\n}\n</code></pre>"},{"location":"mrs/#system-monitor-module-registration","title":"System Monitor Module Registration","text":"<pre><code>{\n  \"module_identity\": {\n    \"module_name\": \"SystemMonitor_Core\",\n    \"module_class\": \"AdvancedSystemMonitor\",\n    \"module_type\": \"monitoring_service\",\n    \"module_version\": \"4.1.0\",\n    \"description\": \"Comprehensive system monitoring with predictive analytics and automated remediation\",\n    \"registration_timestamp\": \"2025-07-31T17:47:53.234Z\"\n  },\n  \"capability_declaration\": {\n    \"provides_events\": [\n      {\n        \"event_type\": \"SYSTEM_METRICS_COLLECTED\",\n        \"description\": \"Published every monitoring cycle with current system metrics\",\n        \"data_schema\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"collection_timestamp\": { \"type\": \"string\", \"format\": \"date-time\" },\n            \"cpu_usage_percent\": {\n              \"type\": \"number\",\n              \"minimum\": 0,\n              \"maximum\": 100\n            },\n            \"memory_usage_percent\": {\n              \"type\": \"number\",\n              \"minimum\": 0,\n              \"maximum\": 100\n            },\n            \"disk_usage_percent\": {\n              \"type\": \"number\",\n              \"minimum\": 0,\n              \"maximum\": 100\n            },\n            \"network_io_mbps\": { \"type\": \"number\", \"minimum\": 0 },\n            \"active_processes\": { \"type\": \"integer\", \"minimum\": 0 },\n            \"load_average\": { \"type\": \"array\", \"items\": { \"type\": \"number\" } },\n            \"uptime_seconds\": { \"type\": \"integer\", \"minimum\": 0 }\n          },\n          \"required\": [\n            \"collection_timestamp\",\n            \"cpu_usage_percent\",\n            \"memory_usage_percent\"\n          ]\n        },\n        \"schema_version\": \"3.0\",\n        \"backward_compatible\": false\n      },\n      {\n        \"event_type\": \"SYSTEM_ALERT_TRIGGERED\",\n        \"description\": \"Published when system metrics exceed defined thresholds\",\n        \"data_schema\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"alert_id\": { \"type\": \"string\" },\n            \"alert_type\": {\n              \"type\": \"string\",\n              \"enum\": [\"cpu\", \"memory\", \"disk\", \"network\", \"process\"]\n            },\n            \"severity\": {\n              \"type\": \"string\",\n              \"enum\": [\"low\", \"medium\", \"high\", \"critical\"]\n            },\n            \"current_value\": { \"type\": \"number\" },\n            \"threshold_value\": { \"type\": \"number\" },\n            \"trending_direction\": {\n              \"type\": \"string\",\n              \"enum\": [\"increasing\", \"decreasing\", \"stable\"]\n            },\n            \"recommended_action\": { \"type\": \"string\" },\n            \"auto_remediation_available\": { \"type\": \"boolean\" }\n          },\n          \"required\": [\n            \"alert_id\",\n            \"alert_type\",\n            \"severity\",\n            \"current_value\",\n            \"threshold_value\"\n          ]\n        },\n        \"schema_version\": \"2.1\",\n        \"backward_compatible\": true\n      }\n    ],\n    \"consumes_events\": [\n      \"SET_MONITORING_THRESHOLD\",\n      \"REQUEST_SYSTEM_REPORT\",\n      \"EXECUTE_REMEDIATION\",\n      \"UPDATE_MONITORING_CONFIG\"\n    ],\n    \"service_metadata\": {\n      \"monitoring_interval_seconds\": 10,\n      \"supported_metrics\": [\n        \"cpu\",\n        \"memory\",\n        \"disk\",\n        \"network\",\n        \"processes\",\n        \"services\"\n      ],\n      \"threshold_types\": [\n        \"absolute\",\n        \"percentage\",\n        \"rate_of_change\",\n        \"predictive\"\n      ],\n      \"remediation_capabilities\": [\n        \"restart_service\",\n        \"clear_cache\",\n        \"scale_resources\"\n      ],\n      \"historical_retention_days\": 30,\n      \"real_time_dashboard\": true,\n      \"api_endpoints\": [\"/metrics\", \"/alerts\", \"/health\"]\n    }\n  },\n  \"technical_requirements\": {\n    \"supported_protocols\": [\"rcs_v2\"],\n    \"dependencies\": [\n      {\n        \"module_name\": \"LoggingModule\",\n        \"version_requirement\": \"&gt;=1.5.0\",\n        \"criticality\": \"optional\"\n      }\n    ],\n    \"resource_requirements\": {\n      \"min_memory_mb\": 256,\n      \"max_memory_mb\": 1024,\n      \"cpu_cores\": 2,\n      \"disk_space_mb\": 1000,\n      \"network_bandwidth_mbps\": 10,\n      \"instance_count\": 1\n    },\n    \"health_check_endpoint\": {\n      \"event_type\": \"MONITOR_HEALTH_CHECK\",\n      \"expected_response\": \"MONITOR_HEALTH_STATUS\",\n      \"timeout_ms\": 2000,\n      \"check_interval_seconds\": 30\n    }\n  },\n  \"registration_metadata\": {\n    \"registration_id\": \"550e8400-e29b-41d4-a716-446655440200\",\n    \"registration_version\": \"1.0\",\n    \"update_mode\": \"merge\",\n    \"registration_source\": \"module_startup\"\n  }\n}\n</code></pre>"},{"location":"mrs/#data-processor-module-registration","title":"Data Processor Module Registration","text":"<pre><code>{\n  \"module_identity\": {\n    \"module_name\": \"DataProcessor_Analytics\",\n    \"module_class\": \"MLDataProcessor\",\n    \"module_type\": \"data_processing_service\",\n    \"module_version\": \"1.5.2\",\n    \"description\": \"Machine learning powered data processing with real-time analytics and pattern detection\",\n    \"registration_timestamp\": \"2025-07-31T17:47:53.345Z\"\n  },\n  \"capability_declaration\": {\n    \"provides_events\": [\n      {\n        \"event_type\": \"DATA_PROCESSED\",\n        \"description\": \"Published when data processing job finishes successfully\",\n        \"data_schema\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"job_id\": {\"type\": \"string\"},\n            \"dataset_name\": {\"type\": \"string\"},\n            \"records_processed\": {\"type\": \"integer\", \"minimum\": 0},\n            \"processing_time_ms\": {\"type\": \"integer\", \"minimum\": 0},\n            \"output_location\": {\"type\": \"string\", \"format\": \"uri\"},\n            \"data_quality_score\": {\"type\": \"number\", \"minimum\": 0, \"maximum\": 1},\n            \"anomalies_detected\": {\"type\": \"integer\", \"minimum\": 0},\n            \"patterns_found\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}},\n            \"confidence_scores\": {\"type\": \"object\"}\n          },\n          \"required\": [\"job_id\", \"dataset_name\", \"records_processed\", \"processing_time_ms\"]\n        },\n        \"schema_version\": \"1.3\",\n        \"backward_compatible\": true\n      },\n      {\n        \"event_type\": \"ANOMALY_DETECTED\",\n</code></pre>"},{"location":"plugin_dev_guide/","title":"Plugin developer guide","text":"<p>RUNE plugins are the primary way to extend the platform. A plugin is an executable on the target node that performs a narrow operational task and returns a structured result.</p> <p>This guide is written for corporate IT and SRE teams building real remediation actions.</p>"},{"location":"plugin_dev_guide/#requirements","title":"Requirements","text":"<p>A plugin must:</p> <ul> <li>read one JSON object from stdin (BPCS input)</li> <li>write exactly one JSON object to stdout (BPCS output)</li> <li>exit with a meaningful code as defined by BPCS</li> <li>avoid writing structured data to stderr</li> </ul> <p>Plugins should:</p> <ul> <li>be idempotent when feasible</li> <li>validate inputs early and fail fast</li> <li>keep scope narrow and explicit</li> <li>avoid printing secrets</li> </ul>"},{"location":"plugin_dev_guide/#recommended-filesystem-layout","title":"Recommended filesystem layout","text":"<ul> <li>Plugin: <code>/opt/rune/plugins/&lt;action_name&gt;</code></li> <li>Shared bash library: <code>/opt/rune/lib/rune_bpcs.sh</code></li> </ul> <p>Standard paths reduce operational friction, packaging work, and incident confusion.</p>"},{"location":"plugin_dev_guide/#bash-plugin-template","title":"Bash plugin template","text":"<pre><code>#!/usr/bin/env bash\nset -euo pipefail\n\n# shellcheck disable=SC1091\nsource /opt/rune/lib/rune_bpcs.sh\n\n# Read input parameters\nSERVICE=$(rune_param \"service\" \"\")\nif [[ -z \"$SERVICE\" ]]; then\n  rune_fail 1 \"Missing required parameter: service\" '{\"parameter\":\"service\"}'\nfi\n\n# Example action\nsystemctl restart \"$SERVICE\"\n\n# Return structured output\nrune_ok \"Service restarted\" \"$(jq -n --arg service \"$SERVICE\" '{service:$service, restarted:true}')\"\n</code></pre> <p>See Bash library reference for the helper functions.</p>"},{"location":"plugin_dev_guide/#input-validation","title":"Input validation","text":"<p>Validation errors should:</p> <ul> <li>return a non zero exit code</li> <li>populate the <code>error</code> object in stdout JSON</li> <li>include a stable numeric code and a concise message</li> </ul> <p>Avoid dumping unstructured text into stdout. Keep stdout reserved for the BPCS JSON object.</p>"},{"location":"plugin_dev_guide/#operational-safety","title":"Operational safety","text":""},{"location":"plugin_dev_guide/#least-privilege","title":"Least privilege","text":"<p>Use a dedicated OS account where possible and grant only required sudo rights for the actions you ship.</p>"},{"location":"plugin_dev_guide/#idempotency-and-reversibility","title":"Idempotency and reversibility","text":"<p>If an action is not idempotent, document it in the action registry metadata and consider requiring explicit operator confirmation.</p>"},{"location":"plugin_dev_guide/#timeouts","title":"Timeouts","text":"<p>Plugins should not run forever. The LMM will enforce timeouts, but plugins should also use reasonable internal timeouts for external commands.</p>"},{"location":"plugin_dev_guide/#testing-plugins","title":"Testing plugins","text":"<ul> <li>test locally with a captured BPCS input JSON file</li> <li>test on a staging node that matches production images</li> <li>simulate failure modes and confirm BPCS and EPS behaviors</li> </ul> <p>See Testing for patterns.</p>"},{"location":"plugin_dev_guide/#documenting-a-plugin","title":"Documenting a plugin","text":"<p>For each plugin, document:</p> <ul> <li>purpose</li> <li>required parameters</li> <li>expected output fields</li> <li>required privileges</li> <li>safe to rerun guidance</li> <li>known failure modes</li> </ul> <p>This documentation is as important as the code in corporate environments.</p>"},{"location":"positioning/","title":"Positioning","text":"<pre><code>flowchart TB\n  A[Signals &amp; Triggers&lt;br/&gt;Monitoring \u2022 SIEM \u2022 SOAR \u2022 ITSM \u2022 On-call] --&gt; B[RUNE&lt;br/&gt;Mediated remediation orchestration]\n\n  B --&gt; C[Action Plugins&lt;br/&gt;Bash/Python \u2022 strict I/O]\n  B --&gt; D[CM / Automation Tools&lt;br/&gt;Ansible \u2022 Salt \u2022 Puppet \u2022 Chef&lt;br/&gt;Terraform adjacent]\n\n  C --&gt; E[Execution Transport&lt;br/&gt;SSH \u2022 AWS SSM]\n  E --&gt; F[Targets&lt;br/&gt;Linux hosts \u2022 instances \u2022 customer-managed envs]\n\n  D -. optional invocation .-&gt; E</code></pre>"},{"location":"positioning/#what-rune-is","title":"What RUNE is","text":"<p>RUNE is an incident-driven remediation orchestrator designed for operational teams. It runs targeted actions (plugins) locally or against remote Linux hosts and returns structured results suitable for automation, auditing, and troubleshooting.</p>"},{"location":"positioning/#what-rune-is-not","title":"What RUNE is not","text":"<ul> <li>RUNE is not a configuration management platform.</li> <li>RUNE does not replace Ansible, Salt, Puppet, or Chef.</li> <li>RUNE does not manage desired state. It executes specific operational actions on demand.</li> </ul>"},{"location":"positioning/#how-rune-complements-fleet-tooling","title":"How RUNE complements fleet tooling","text":"<p>RUNE can invoke configuration or automation tools as part of a remediation action when that is the safest or most repeatable path. The core value is controlled execution, consistent outputs, and predictable error handling for incident response workflows.</p>"},{"location":"positioning/#typical-use-cases","title":"Typical use cases","text":"<ul> <li>Restart or validate a critical service after an alert</li> <li>Remediate disk pressure (cleanup, rotation, expansion workflows)</li> <li>Confirm certificate or TLS configuration health</li> <li>Apply a targeted network change to restore connectivity</li> </ul>"},{"location":"quick_start/","title":"Quick Start","text":"<p>This quick start shows an end to end action execution against a remote Linux node.</p> <p>The goal is to demonstrate the contract:</p> <ul> <li>CLI triggers an action</li> <li>LOM and LMM mediate execution</li> <li>plugin receives JSON via stdin (BPCS)</li> <li>plugin emits a single JSON object via stdout (BPCS)</li> <li>failures are returned as EPS</li> </ul>"},{"location":"quick_start/#prerequisites","title":"Prerequisites","text":"<ul> <li>A Linux host you can reach via SSH (or AWS SSM, if enabled in your build)</li> <li>A user with permission to run the required remediation commands</li> <li>Python installed locally for the RUNE CLI</li> </ul>"},{"location":"quick_start/#1-install-the-cli","title":"1. Install the CLI","text":"<pre><code>python -m pip install rune-framework\n</code></pre> <p>Verify:</p> <pre><code>rune --help\n</code></pre>"},{"location":"quick_start/#2-install-a-plugin-on-the-target-node","title":"2. Install a plugin on the target node","text":"<p>RUNE plugins are executables that follow BPCS. The default convention is:</p> <ul> <li>Plugins: <code>/opt/rune/plugins/&lt;action&gt;</code></li> <li>Shared bash library: <code>/opt/rune/lib/rune_bpcs.sh</code></li> </ul> <p>Create a simple health check plugin on the target node:</p> <pre><code>sudo install -d /opt/rune/plugins /opt/rune/lib\nsudo tee /opt/rune/plugins/health_check &gt;/dev/null &lt;&lt;'EOF'\n#!/usr/bin/env bash\nset -euo pipefail\n\n# shellcheck disable=SC1091\nsource /opt/rune/lib/rune_bpcs.sh\n\n# Example: gather a small set of structured facts\nUPTIME=$(cut -d. -f1 /proc/uptime)\nLOAD=$(cut -d' ' -f1 /proc/loadavg)\n\nrune_ok \"Host health collected\" \"$(jq -n --arg uptime \"$UPTIME\" --arg load \"$LOAD\" '{uptime_seconds: ($uptime|tonumber), load_1m: ($load|tonumber)}')\"\nEOF\nsudo chmod +x /opt/rune/plugins/health_check\n</code></pre> <p>Install the bash library (copy from the repo or release artifact used by your deployment). For development, you can place the project version at <code>/opt/rune/lib/rune_bpcs.sh</code>.</p>"},{"location":"quick_start/#3-run-the-action","title":"3. Run the action","text":"<pre><code>rune run health_check --node myhost01 --json\n</code></pre> <p>Expected output (shape):</p> <pre><code>{\n  \"payload\": {\n    \"result\": \"success\",\n    \"output_data\": {\n      \"uptime_seconds\": 12345,\n      \"load_1m\": 0.12\n    }\n  },\n  \"error\": null\n}\n</code></pre>"},{"location":"quick_start/#4-what-happens-on-errors","title":"4. What happens on errors","text":"<p>If a plugin returns a non zero exit code or an <code>error</code> payload, the LMM normalizes the failure and returns an EPS error envelope (or an EPS shaped error section in the CLI response, depending on output mode).</p> <p>In practice, that means:</p> <ul> <li>your automation can reliably detect failure</li> <li>your logging pipeline can index error codes and fingerprints</li> <li>operators get a human readable summary that still maps to structured fields</li> </ul>"},{"location":"quick_start/#next-steps","title":"Next steps","text":"<ul> <li>Install for deployment options and prerequisites</li> <li>Architecture for component responsibilities and execution flow</li> <li>Plugin Developer Guide to build real remediation actions</li> <li>BPCS for the plugin contract</li> <li>EPS for structured errors</li> </ul>"},{"location":"rcs/","title":"Runtime Communication Specification (RCS)","text":"<p>This is the canonical runtime message envelope used by RUNE modules (LOM, LMM, ErrorHandler) for request correlation and routing.</p> <p>For a shorter operational overview, see Architecture and Mediation model.</p>"},{"location":"rcs/#overview","title":"Overview","text":"<p>This document defines the standardized data format for all runtime communication within the RUNE platform. All operational messaging-between modules, or between modules and plugins-flows exclusively through the RUNE Mediator Module (LMM). No direct communication between modules or plugins is permitted; all interactions are strictly mediated by the LMM.</p> <p>The RCS is designed for high-frequency operational messaging and prioritizes lightweight, efficient communication. For module capability declaration and registration, see the Module Registration Specification (MRS). For error handling and recovery messaging, see the Error Protocol Specification (EPS).</p>"},{"location":"rcs/#protocol-architecture-context","title":"Protocol Architecture Context","text":"<p>The RUNE platform operates on a three-protocol architecture that ensures separation of concerns and optimal performance:</p> Protocol Purpose Managed By Frequency Use Case MRS Module registration and capability declaration Orchestrator (LOM) Low (startup/shutdown) Module and plugin lifecycle management RCS Runtime operational communication Mediator (LMM) High (continuous) All runtime messaging between modules and plugins EPS Error handling and recovery messaging Mediator (LMM) + ErrorHandler Variable (exception-based) Error responses and recovery <p>Architecture Principles:</p> <ul> <li>Mediator-Centric: ALL runtime communication-between modules, or between modules and plugins-flows through the LMM.</li> <li>No Direct Communication: Modules and plugins never communicate directly with each other.</li> <li>Plugin Mediation: All plugin (RICI) invocation, output, and error handling is exclusively managed by the LMM.</li> <li>Orchestrator Registry: The LMM uses the Orchestrator's (LOM) module and plugin registry for routing decisions.</li> <li>Protocol Separation: Each protocol is optimized for its specific role and frequency.</li> <li>Loose Coupling: Changes to one module or plugin do not directly impact others.</li> </ul>"},{"location":"rcs/#when-to-use-this-specification","title":"When to Use This Specification","text":"Use Case Specification Purpose Module-to-Module Communication RCS Runtime operational messaging between registered modules Request-Response Patterns RCS Synchronous and asynchronous communication workflows Event Publishing/Subscribing RCS Broadcasting events to interested modules Health Check Responses RCS Responding to orchestrator health checks Business Logic Operations RCS Normal processing, data transformation, notifications Module Registration MRS Declaring module capabilities and subscribing to events Capability Updates MRS Updating module event schemas or dependencies Error Responses EPS All error conditions, validation failures, system errors Recovery Actions EPS Error escalation, module restart commands, failure notifications <p>Decision Rule: Use RCS for all runtime operational communication-whether between modules, or between modules and plugins. No direct communication is allowed; the LMM is always the mediator.</p> <p>Cross-Protocol References:</p> <ul> <li>See Module Registration Specification (MRS) for module capability declaration.</li> <li>See Error Protocol Specification (EPS) for error handling and recovery messaging.</li> </ul>"},{"location":"rcs/#message-structure","title":"Message Structure","text":""},{"location":"rcs/#complete-format-example","title":"Complete Format Example","text":"<pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"correlation_id\": \"550e8400-e29b-41d4-a716-446655440001\",\n    \"parent_message_id\": \"550e8400-e29b-41d4-a716-446655440002\",\n    \"created_at\": \"2025-07-31T17:47:53.123Z\",\n    \"expires_at\": \"2025-07-31T17:52:53.123Z\",\n    \"priority\": \"normal\",\n    \"delivery_mode\": \"at_least_once\"\n  },\n  \"routing\": {\n    \"event_type\": \"DATA_PROCESSED\",\n    \"event_category\": \"processing\",\n    \"source_module\": \"DataProcessor\",\n    \"routing_tags\": [\"analytics\", \"batch\"],\n    \"reply_to\": {\n      \"event_type\": \"DATA_PROCESS_RESPONSE\",\n      \"timeout_ms\": 5000\n    }\n  },\n  \"payload\": {\n    \"schema_version\": \"rcs_v2\",\n    \"content_type\": \"application/json\",\n    \"encoding\": \"utf-8\",\n    \"size_bytes\": 256,\n    \"checksum\": \"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\n    \"data\": {\n      \"status\": \"completed\",\n      \"records_processed\": 1250,\n      \"processing_time_ms\": 3400\n    }\n  },\n  \"quality_of_service\": {\n    \"max_retries\": 3,\n    \"retry_delay_ms\": 1000,\n    \"acknowledgment_required\": true,\n    \"dead_letter_queue\": true\n  },\n  \"security\": {\n    \"sender_identity\": \"data-processor-v1.3\",\n    \"signature\": \"base64-encoded-signature\",\n    \"encryption_key_id\": \"key-123\",\n    \"access_level\": \"internal\"\n  },\n  \"observability\": {\n    \"trace_id\": \"distributed-trace-id\",\n    \"span_id\": \"span-id\"\n  }\n}\n</code></pre>"},{"location":"rcs/#field-specifications","title":"Field Specifications","text":""},{"location":"rcs/#message-metadata-section","title":"Message Metadata Section","text":"Field Type Required Purpose <code>version</code> String Yes RCS protocol version for backward compatibility (current: \"1.0\") <code>message_id</code> UUID String Yes Unique identifier for message deduplication and tracking <code>correlation_id</code> UUID String No Links related messages across workflow operations <code>parent_message_id</code> UUID String No Creates message threading for causality tracking <code>created_at</code> RFC 3339 String Yes Message creation timestamp in UTC (format: YYYY-MM-DDTHH:MM:SS.sssZ) <code>expires_at</code> RFC 3339 String No Message expiration for time-sensitive events <code>priority</code> Enum String No Message priority: <code>critical</code>, <code>high</code>, <code>normal</code>, <code>low</code> (default: <code>normal</code>) <code>delivery_mode</code> Enum String No Delivery guarantee: <code>at_most_once</code>, <code>at_least_once</code>, <code>exactly_once</code> (default: <code>at_least_once</code>)"},{"location":"rcs/#routing-section","title":"Routing Section","text":"Field Type Required Purpose <code>event_type</code> String Yes Primary routing key defining the service contract <code>event_category</code> String No Secondary classification for broad event grouping <code>source_module</code> String Yes Identity of the publishing module <code>routing_tags</code> Array[String] No Additional routing criteria for complex subscriptions <code>reply_to</code> Object No Request-response pattern configuration <code>reply_to.event_type</code> String No Expected response event type <code>reply_to.timeout_ms</code> Integer No Response timeout in milliseconds <p>Event Type Naming Convention:</p> <ul> <li>Use past tense for completed actions: <code>DATA_PROCESSED</code>, <code>EMAIL_SENT</code>, <code>USER_AUTHENTICATED</code></li> <li>Use present tense for commands/requests: <code>PROCESS_DATA</code>, <code>SEND_EMAIL</code>, <code>AUTHENTICATE_USER</code></li> <li>Use noun phrases for status: <code>SYSTEM_STATUS</code>, <code>HEALTH_CHECK</code></li> </ul>"},{"location":"rcs/#payload-section","title":"Payload Section","text":"Field Type Required Purpose <code>schema_version</code> String Yes Version of RCS protocol being used (current: \"rcs_v2\") <code>content_type</code> String Yes MIME type of payload content (e.g., <code>application/json</code>) <code>encoding</code> String No Character encoding for text payloads (default: <code>utf-8</code>) <code>size_bytes</code> Integer Yes Payload size for validation and resource planning <code>checksum</code> String No SHA-256 hash for data integrity verification <code>data</code> Any Yes The actual message content"},{"location":"rcs/#quality-of-service-section","title":"Quality of Service Section","text":"Field Type Required Purpose <code>max_retries</code> Integer No Maximum retry attempts for failed delivery (default: 0) <code>retry_delay_ms</code> Integer No Initial delay between retries in milliseconds <code>acknowledgment_required</code> Boolean No Whether delivery confirmation is needed (default: false) <code>dead_letter_queue</code> Boolean No Send to DLQ after max retries exceeded (default: false)"},{"location":"rcs/#security-section","title":"Security Section","text":"Field Type Required Purpose <code>sender_identity</code> String No Authenticated sender identifier <code>signature</code> String No Digital signature for message integrity <code>encryption_key_id</code> String No Reference to encryption key if payload is encrypted <code>access_level</code> Enum String No Security classification: <code>public</code>, <code>internal</code>, <code>restricted</code>, <code>confidential</code>"},{"location":"rcs/#observability-section","title":"Observability Section","text":"Field Type Required Purpose <code>trace_id</code> String No Distributed tracing identifier <code>span_id</code> String No Tracing span identifier"},{"location":"rcs/#error-handling","title":"Error Handling","text":"<p>RCS does not define error message formats. All error responses use the Error Protocol Specification (EPS) format.</p> <p>When RCS message processing encounters errors, the response follows EPS format instead of RCS format. Common error scenarios include:</p>"},{"location":"rcs/#when-eps-is-used-instead-of-rcs","title":"When EPS is Used Instead of RCS","text":"Error Condition Protocol Used Handling Component JSON parse failure EPS Mediator Schema validation fail EPS Mediator Module not found EPS Mediator Message timeout EPS Mediator Business logic error EPS Target Module System resource error EPS System Monitor"},{"location":"rcs/#error-response-flow","title":"Error Response Flow","text":"<pre><code>flowchart TD\n    A[Module A] --&gt;|RCS Message| M[Mediator]\n    M --&gt;|Validation Error| EPS{Generate EPS Error}\n    M --&gt;|Valid Message| B[Module B]\n    B --&gt;|Business Error| EPS2{Generate EPS Error}\n    EPS --&gt;|EPS Format| EH[ErrorHandler]\n    EPS2 --&gt;|EPS Format| EH\n    EH --&gt;|Recovery Action| M\n    M --&gt;|RCS Format| A</code></pre> <p>For complete error handling specifications, see: Error Protocol Specification (EPS)</p>"},{"location":"rcs/#minimal-required-message","title":"Minimal Required Message","text":"<p>The absolute minimum valid message contains only required fields:</p> <pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"created_at\": \"2025-07-31T17:47:53.123Z\"\n  },\n  \"routing\": {\n    \"event_type\": \"SYSTEM_HEARTBEAT\",\n    \"source_module\": \"SystemMonitor\"\n  },\n  \"payload\": {\n    \"schema_version\": \"rcs_v2\",\n    \"content_type\": \"application/json\",\n    \"size_bytes\": 25,\n    \"data\": {\n      \"status\": \"healthy\"\n    }\n  }\n}\n</code></pre>"},{"location":"rcs/#example-implementation-logging-module","title":"Example Implementation: Logging Module","text":"<p>Here's an example of how a logging module would use the RCS format:</p> <pre><code>{\n  \"message_metadata\": {\n    \"version\": \"1.0\",\n    \"message_id\": \"770e8400-e29b-41d4-a716-446655440123\",\n    \"correlation_id\": \"workflow-abc-123\",\n    \"created_at\": \"2025-07-31T17:47:53.456Z\",\n    \"priority\": \"high\"\n  },\n  \"routing\": {\n    \"event_type\": \"LOG_MESSAGE\",\n    \"event_category\": \"logging\",\n    \"source_module\": \"SecurityScanner\",\n    \"routing_tags\": [\"security\", \"audit\", \"authentication\"]\n  },\n  \"payload\": {\n    \"schema_version\": \"rcs_v2\",\n    \"content_type\": \"application/json\",\n    \"size_bytes\": 189,\n    \"data\": {\n      \"log_level\": \"WARNING\",\n      \"message\": \"Failed login attempt detected\",\n      \"timestamp\": \"2025-07-31T17:47:53.456Z\",\n      \"details\": {\n        \"username\": \"admin\",\n        \"source_ip\": \"192.168.1.100\",\n        \"attempt_count\": 3,\n        \"user_agent\": \"Mozilla/5.0...\"\n      }\n    }\n  },\n  \"security\": {\n    \"access_level\": \"restricted\"\n  },\n  \"observability\": {\n    \"trace_id\": \"auth-trace-456\",\n    \"span_id\": \"login-validation-span\"\n  }\n}\n</code></pre>"},{"location":"rcs/#implementation-notes","title":"Implementation Notes","text":"<ol> <li>Timestamps: All timestamps must be in RFC 3339 format with UTC timezone (YYYY-MM-DDTHH:MM:SS.sssZ)</li> <li>UUIDs: Use UUID v4 for all identifier fields</li> <li>Checksums: Use SHA-256 for payload integrity verification</li> <li>Size Validation: <code>size_bytes</code> must match actual payload size</li> <li>Extensibility: Additional fields may be added to any section without breaking compatibility</li> <li>Protocol Version: This is RCS version 1.0. The <code>version</code> field in <code>message_metadata</code> refers to the RCS protocol version</li> <li>Schema Version: The <code>schema_version</code> field in payload refers to RCS protocol version (current: \"rcs_v2\")</li> <li>Relationship to Other Protocols:</li> <li>Module capabilities declared using MRS format</li> <li>Runtime communication uses RCS format</li> <li>Error responses use EPS format</li> <li>Communication Architecture: All messages flow through Mediator; no direct module-to-module communication</li> <li>Registry Integration: Mediator uses Orchestrator's module registry for routing decisions</li> </ol> <p>This format ensures robust, secure, and observable inter-module communication while maintaining the flexibility required for future system evolution.</p>"},{"location":"rcs/#example-memory-check-workflow-communication","title":"Example: Memory Check Workflow Communication","text":"<p>The following mermaid diagram visually reinforces that all plugin interactions (invocation, output, errors) are mediated by the LMM:</p> <pre><code>flowchart TD\n    Start([Start Workflow]) --&gt; O[\"\ud83c\udfaf Orchestrator (LOM)\"]\n\n    O --&gt;|Execute Script| M[\"\u26a1 Mediator (LMM)\"]\n    M --&gt; SE[\"\ud83d\udd27 Plugin: ScriptExecutor\"]\n\n    SE --&gt;|Log Start| M\n    M --&gt; LM1[\"\ud83d\udcdd Logger\"]\n\n    SE --&gt;|Return Results| M\n    M --&gt; O\n\n    SE --&gt;|Log Results| M\n    M --&gt; LM2[\"\ud83d\udcdd Logger\"]\n\n    O --&gt;|Log Complete| M\n    M --&gt; LM3[\"\ud83d\udcdd Logger\"]\n\n    LM3 --&gt; EndNode([End Workflow])\n\n    classDef orchestrator fill:#e1f5fe,stroke:#0277bd,stroke-width:2px\n    classDef mediator fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px\n    classDef plugin fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px\n    classDef logger fill:#fff3e0,stroke:#ef6c00,stroke-width:2px\n\n    class O orchestrator\n    class M mediator\n    class SE plugin\n    class LM1,LM2,LM3 logger</code></pre>"},{"location":"rcs/#key-framework-features-demonstrated","title":"Key Framework Features Demonstrated","text":""},{"location":"rcs/#1-mediator-pattern","title":"1. Mediator Pattern","text":"<ul> <li>All communication flows through the Mediator.</li> <li>Modules never communicate directly with each other.</li> <li>Event-type based routing (<code>EXECUTE_SCRIPT</code>, <code>LOG_MESSAGE</code>, <code>SCRIPT_EXECUTED</code>).</li> </ul>"},{"location":"rcs/#2-service-abstraction","title":"2. Service Abstraction","text":"<ul> <li>Orchestrator doesn't know which specific script execution module handles the request.</li> <li>Any module subscribing to <code>EXECUTE_SCRIPT</code> could fulfill the request.</li> <li>Logging is handled by event type, not module name.</li> </ul>"},{"location":"rcs/#3-message-threading","title":"3. Message Threading","text":"<ul> <li><code>correlation_id</code> links all messages in the workflow.</li> <li><code>parent_message_id</code> shows message causality.</li> <li><code>trace_id</code> enables distributed tracing across the entire workflow.</li> </ul>"},{"location":"rcs/#4-loose-coupling","title":"4. Loose Coupling","text":"<ul> <li>Script Executor could be swapped for a different implementation.</li> <li>Logging Module could be replaced with a different logging service.</li> <li>Orchestrator remains unchanged regardless of underlying implementations.</li> </ul>"},{"location":"rcs/#5-observable-workflow","title":"5. Observable Workflow","text":"<ul> <li>Complete audit trail through logging.</li> <li>Tracing support for performance analysis.</li> <li>Error handling and timeout management built-in.</li> </ul> <p>This example shows how the event-driven architecture enables complex workflows while maintaining modularity, observability, and the ability to swap service implementations without affecting other components.</p>"},{"location":"roadmap/","title":"Roadmap","text":"<p>This roadmap focuses on capabilities that matter in corporate IT operations: safety, observability, controlled extensibility, and predictable execution.</p> <p>RUNE is protocol first. The protocol contracts (RCS, MRS, BPCS, EPS) are stable foundations. Features build on top without breaking those contracts.</p>"},{"location":"roadmap/#phase-0-contract-alignment","title":"Phase 0: Contract alignment","text":"<ul> <li>RCS, MRS, BPCS, EPS published and treated as canonical</li> <li>LOM and LMM implement mediation and registry behaviors</li> <li>CLI provides deterministic action execution and JSON output</li> </ul>"},{"location":"roadmap/#phase-1-transport-hardening","title":"Phase 1: Transport hardening","text":"<ul> <li>SSH transport improvements (timeouts, retries, concurrency control)</li> <li>SSM transport support where available</li> <li>node identity and inventory integration hooks</li> </ul>"},{"location":"roadmap/#phase-2-registry-and-discovery","title":"Phase 2: Registry and discovery","text":"<ul> <li>action catalog generation from plugin bundles</li> <li>operator friendly action listing and description</li> <li>per action policy metadata (timeouts, approvals, risk flags)</li> </ul>"},{"location":"roadmap/#phase-3-observability-and-audit","title":"Phase 3: Observability and audit","text":"<ul> <li>structured logs suitable for SIEM ingestion</li> <li>trace propagation and correlation improvements</li> <li>EPS fingerprint and error taxonomy stabilization</li> </ul>"},{"location":"roadmap/#phase-4-packaging-and-distribution","title":"Phase 4: Packaging and distribution","text":"<ul> <li>plugin bundle packaging patterns (RPM/DEB or internal artifact pipelines)</li> <li>version compatibility story between CLI, core, and plugin bundles</li> <li>signed artifact support in controlled environments</li> </ul>"},{"location":"roadmap/#phase-5-workflow-features","title":"Phase 5: Workflow features","text":"<ul> <li>optional action chaining driven by explicit policy</li> <li>guardrails for high impact sequences</li> <li>richer rollback and compensating action modeling</li> </ul>"},{"location":"roadmap/#non-goals","title":"Non goals","text":"<ul> <li>RUNE is not a full configuration management or state enforcement platform</li> <li>RUNE does not aim to replace SSH, SSM, or existing access control systems</li> </ul> <p>For implementation priorities, align roadmap work with real operational needs: what your on call engineers actually do under pressure.</p>"},{"location":"security_model/","title":"Security model","text":"<p>RUNE is designed for corporate IT environments where remote remediation is powerful and therefore risky. The security model is built around separation of concerns and explicit trust boundaries.</p> <p>RUNE assumes you already have an authenticated and authorized transport. RUNE does not invent a new remote access system. It uses established mechanisms (SSH or SSM) and focuses on safe execution, observability, and consistent outcomes.</p>"},{"location":"security_model/#trust-boundaries","title":"Trust boundaries","text":""},{"location":"security_model/#operator-boundary","title":"Operator boundary","text":"<p>The CLI is an operator interface. Your organization controls:</p> <ul> <li>who is allowed to run RUNE</li> <li>which actions they can execute</li> <li>how approvals are handled (change management, break glass)</li> </ul>"},{"location":"security_model/#mediation-boundary","title":"Mediation boundary","text":"<p>The LMM is the enforcement point. It is responsible for:</p> <ul> <li>transport selection and configuration</li> <li>output validation and normalization</li> <li>consistent error handling and routing</li> <li>applying timeouts and retry policy</li> </ul> <p>Plugins never bypass mediation.</p>"},{"location":"security_model/#target-node-boundary","title":"Target node boundary","text":"<p>Plugins execute on the target node with the privileges available to the transport user.</p> <p>This is deliberate. In most corporate environments, privilege is managed via:</p> <ul> <li>sudo policies</li> <li>SSM command execution policies</li> <li>OS level access controls</li> </ul> <p>RUNE does not replace those systems.</p>"},{"location":"security_model/#threat-model-highlights","title":"Threat model highlights","text":""},{"location":"security_model/#risk-arbitrary-command-execution","title":"Risk: arbitrary command execution","text":"<p>RUNE executes scripts on remote nodes. This is inherently high impact.</p> <p>Mitigations:</p> <ul> <li>controlled plugin distribution (package repo, signed artifacts, change control)</li> <li>narrow plugin scope and least privilege sudo rules</li> <li>registry driven allow lists and policy enforcement in LOM</li> <li>explicit high impact action flags that require operator acknowledgment</li> </ul>"},{"location":"security_model/#risk-untrusted-plugin-output","title":"Risk: untrusted plugin output","text":"<p>Plugins are treated as untrusted input. The LMM:</p> <ul> <li>requires one JSON object on stdout</li> <li>captures stderr separately</li> <li>validates the BPCS structure before trusting any fields</li> <li>normalizes failures into EPS for consistent handling</li> </ul>"},{"location":"security_model/#risk-secrets-exposure","title":"Risk: secrets exposure","text":"<p>Plugins should not print secrets. RUNE supports structured output, so you can:</p> <ul> <li>avoid dumping configuration files</li> <li>return only required values</li> <li>keep verbose diagnostics in stderr and restrict log collection</li> </ul> <p>Operationally, handle secrets via:</p> <ul> <li>environment injection from your secret manager</li> <li>SSM parameters or secure files on node</li> <li>minimal output policies in your log pipeline</li> </ul>"},{"location":"security_model/#risk-replay-and-tampering-future-capable","title":"Risk: replay and tampering (future capable)","text":"<p>RCS and EPS include optional security metadata fields (identity, signatures, key ids). These exist so deployments can add message signing or encryption where needed, without changing the envelope shape.</p> <p>If you do not implement signing, do not rely on these fields for security. Rely on the transport security and operational controls.</p>"},{"location":"security_model/#audit-and-observability","title":"Audit and observability","text":"<p>RUNE is designed to be auditable:</p> <ul> <li>message id and correlation id provide request lineage</li> <li>trace id and span id support cross system correlation</li> <li>errors are normalized into EPS with fingerprints and context</li> </ul> <p>This makes it practical to feed RUNE outputs into SIEM and incident management systems.</p>"},{"location":"security_model/#recommended-operational-practices","title":"Recommended operational practices","text":"<ul> <li>treat plugin bundles as production artifacts with review and versioning</li> <li>run RUNE from controlled runners (CI, automation hosts) rather than laptops where possible</li> <li>keep actions small, idempotent when feasible, and explicitly reversible when not</li> <li>log structured results centrally and restrict raw stderr logs as needed</li> </ul>"},{"location":"testing/","title":"Testing","text":"<p>RUNE testing has two goals:</p> <ul> <li>verify the platform behaviors (mediation, transport, normalization)</li> <li>verify plugin behaviors (inputs, outputs, exit codes, safety)</li> </ul> <p>In corporate environments, the safest way to scale runbooks is to test them like software.</p>"},{"location":"testing/#test-layers","title":"Test layers","text":""},{"location":"testing/#1-unit-tests-core","title":"1. Unit tests (core)","text":"<p>Core code should be unit tested for:</p> <ul> <li>schema validation</li> <li>routing decisions based on registry entries</li> <li>output normalization and EPS generation</li> <li>transport adapter argument formation</li> </ul>"},{"location":"testing/#2-plugin-contract-tests","title":"2. Plugin contract tests","text":"<p>Plugins should be tested for strict BPCS compliance:</p> <ul> <li>reads one JSON object from stdin</li> <li>writes one JSON object to stdout</li> <li>returns correct exit code</li> <li>never prints structured output to stderr</li> </ul> <p>A simple approach is to keep sample BPCS inputs and expected outputs in a <code>tests/</code> directory in the plugin repository.</p>"},{"location":"testing/#3-integration-tests-local","title":"3. Integration tests (local)","text":"<p>Run the CLI against a local container or VM where you control the plugin install path. Validate:</p> <ul> <li>RCS request construction and correlation</li> <li>correct plugin selection and invocation</li> <li>output parsing and validation</li> <li>error behavior when plugin fails or output is malformed</li> </ul>"},{"location":"testing/#4-integration-tests-staging-fleet","title":"4. Integration tests (staging fleet)","text":"<p>Before enabling a plugin action for production incident use, validate it on:</p> <ul> <li>representative OS images</li> <li>representative service configurations</li> <li>representative permission models</li> </ul>"},{"location":"testing/#failure-mode-testing","title":"Failure mode testing","text":"<p>A plugin that works only on the happy path is not an operational tool.</p> <p>Test:</p> <ul> <li>missing parameters</li> <li>dependency failures</li> <li>permission failures</li> <li>partial success cases</li> <li>timeouts</li> </ul> <p>Confirm that failures result in:</p> <ul> <li>BPCS error payload</li> <li>meaningful exit codes</li> <li>EPS normalization at the platform boundary</li> </ul>"},{"location":"testing/#operational-readiness-checks","title":"Operational readiness checks","text":"<p>For each action you intend to run during incidents, capture:</p> <ul> <li>required privileges</li> <li>expected runtime</li> <li>safe to rerun guidance</li> <li>rollback or compensating actions if needed</li> <li>owner team and escalation contact</li> </ul> <p>This information should be stored in the registry metadata (MRS) and the plugin documentation.</p>"},{"location":"why_rune/","title":"Why RUNE","text":"<p>Most IT organizations already have runbooks. The problem is that runbooks are usually:</p> <ul> <li>tribal knowledge in a wiki</li> <li>copy paste SSH commands with no audit trail</li> <li>brittle scripts that do not return machine readable results</li> <li>safe only in the hands of the person who wrote them</li> </ul> <p>RUNE is a way to turn runbooks into deterministic actions that can be executed consistently across environments, with results that are safe for automation.</p>"},{"location":"why_rune/#the-operational-gap-rune-targets","title":"The operational gap RUNE targets","text":"<p>Corporate IT often lives between these two worlds:</p> <ul> <li>Stateful automation tools (configuration management, IaC) that are excellent for planned change and drift control</li> <li>Interactive break glass work (SSH, consoles) that is common during incidents</li> </ul> <p>During an incident, you need something that is:</p> <ul> <li>targeted and fast</li> <li>safe to run repeatedly</li> <li>auditable and observable</li> <li>easy to integrate into ticketing, chatops, and SOAR workflows</li> </ul> <p>RUNE sits in that gap.</p>"},{"location":"why_rune/#what-makes-rune-different","title":"What makes RUNE different","text":""},{"location":"why_rune/#protocol-first-design","title":"Protocol first design","text":"<p>Every action execution uses strict JSON message envelopes, so you can:</p> <ul> <li>log and index results reliably</li> <li>integrate with external systems without parsing free form text</li> <li>enforce consistency across transports and plugin implementations</li> </ul>"},{"location":"why_rune/#mediation-as-a-safety-boundary","title":"Mediation as a safety boundary","text":"<p>RUNE enforces a mediation boundary. Plugins do not choose transports, do not reach into other components directly, and do not decide how errors propagate. The LMM is the control point for:</p> <ul> <li>transport selection (SSH or SSM)</li> <li>execution constraints and timeouts</li> <li>output validation</li> <li>error routing and normalization</li> </ul> <p>This design reduces the blast radius of scripts.</p>"},{"location":"why_rune/#pluggable-by-default","title":"Pluggable by default","text":"<p>RUNE does not ship as a monolith with a thousand built in behaviors. It is a platform for executing your organization\u2019s curated actions.</p> <p>That makes it a good fit for environments with:</p> <ul> <li>strong operational controls</li> <li>security requirements</li> <li>many bespoke internal services</li> <li>customer managed or heterogeneous infrastructure</li> </ul>"},{"location":"why_rune/#typical-use-cases","title":"Typical use cases","text":"<ul> <li>Restart or repair a service and confirm health afterwards</li> <li>Flush a queue, clear stuck locks, rotate credentials, or rehydrate a config</li> <li>Validate host requirements before enabling a feature</li> <li>Gather structured diagnostics for a ticket or incident timeline</li> <li>Apply a narrowly scoped remediation, then collect evidence of success</li> </ul>"},{"location":"why_rune/#how-this-helps-in-a-job-portfolio","title":"How this helps in a job portfolio","text":"<p>RUNE documents the kind of work that matters in corporate IT and security engineering:</p> <ul> <li>clear operational contracts</li> <li>safety boundaries and threat modeling</li> <li>structured observability and error handling</li> <li>plugin based extensibility</li> <li>pragmatic transport support for real environments</li> </ul> <p>The docs are written for people who operate systems, not for people collecting buzzwords.</p>"},{"location":"legal/CLA/","title":"Contributor License Agreement (CLA)","text":"<p>Thank you for your interest in contributing to the RUNUE project.</p> <p>By submitting a pull request, issue, or other contribution, you agree to the following terms:</p>"},{"location":"legal/CLA/#1-grant-of-copyright-license","title":"1. Grant of Copyright License","text":"<p>You hereby grant to Richard Majewski (the project maintainer) and any recipients of your contributions a perpetual, worldwide, non-exclusive, royalty-free, irrevocable license under copyright to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute your contributions and such derivative works.</p>"},{"location":"legal/CLA/#2-originality","title":"2. Originality","text":"<p>You affirm that:</p> <ul> <li>You are the sole author of your contribution, or</li> <li>You have the right to submit the contribution under an open source license, and</li> <li>Your contribution does not knowingly infringe upon any third-party intellectual property.</li> </ul>"},{"location":"legal/CLA/#3-license-notice","title":"3. License Notice","text":"<p>All contributions to RUNUE must be compatible with the MPL-2.0 license. By default, your contribution is licensed under the same terms unless explicitly noted.</p>"},{"location":"legal/CLA/#4-no-warranty","title":"4. No Warranty","text":"<p>Contributions are provided \"as is\" without warranty of any kind, express or implied. RUNUE and its maintainers are under no obligation to include or use your contribution.</p>"},{"location":"legal/CLA/#5-recordkeeping","title":"5. Recordkeeping","text":"<p>Contributions submitted via GitHub (PRs, issues, comments) constitute a signed CLA under GitHub Terms of Use.</p> <p>If you prefer a signed physical CLA or have any questions, please contact the project maintainer before contributing.</p>"},{"location":"legal/LICENSE/","title":"Mozilla Public License Version 2.0","text":""},{"location":"legal/LICENSE/#1-definitions","title":"1. Definitions","text":"<p>1.1. \"Contributor\" means each individual or legal entity that creates, contributes to the creation of, or owns Covered Software.</p> <p>1.2. \"Contributor Version\" means the combination of the Contributions of others (if any) used by a Contributor and that particular Contributor's Contribution.</p> <p>1.3. \"Contribution\" means Covered Software of a particular Contributor.</p> <p>1.4. \"Covered Software\" means Source Code Form to which the initial Contributor has attached the notice in Exhibit A, the Executable Form of such Source Code Form, and Modifications of such Source Code Form.</p> <p>1.5. \"Executable Form\" means any form of the work other than Source Code Form.</p> <p>1.6. \"Larger Work\" means a work that combines Covered Software with other material, in a separate file or files, that is not Covered Software.</p> <p>1.7. \"Modifications\" means any of the following:</p> <ul> <li>(a) Any file in Source Code Form that results from an addition to, deletion from, or modification of the contents of Covered Software;</li> <li>(b) Any new file in Source Code Form that contains any Covered Software; or</li> <li>(c) Any new file that is contributed or otherwise made available under the terms of this License.</li> </ul> <p>1.8. \"Source Code Form\" means the form of the work preferred for making modifications.</p> <p>1.9. \"You\" (or \"Your\") means an individual or a legal entity exercising rights under this License. For legal entities, \"You\" includes any entity that controls, is controlled by, or is under common control with You.</p>"},{"location":"legal/LICENSE/#2-license-grants-and-conditions","title":"2. License Grants and Conditions","text":""},{"location":"legal/LICENSE/#21-grants","title":"2.1. Grants","text":"<p>Subject to the terms of this License, each Contributor grants You a worldwide, royalty-free, non-exclusive license:</p> <ul> <li>(a) Under intellectual property rights (other than patent or trademark) to use, reproduce, modify, display, perform, distribute, and otherwise exploit its Contributions, with or without Modifications, in Source Code Form or Executable Form; and</li> <li>(b) Under Patent Claims of such Contributor to make, use, sell, offer for sale, have made, import, and otherwise transfer either its Contributions or its Contributor Version.</li> </ul>"},{"location":"legal/LICENSE/#22-effective-date","title":"2.2. Effective Date","text":"<p>The licenses granted in Section 2.1 become effective for each file of Covered Software on the date the Contributor first distributes such file.</p>"},{"location":"legal/LICENSE/#23-limitations","title":"2.3. Limitations","text":"<p>No trademark or patent rights are granted by this License.</p>"},{"location":"legal/LICENSE/#24-subsequent-licenses","title":"2.4. Subsequent Licenses","text":"<p>Each Contributor may choose to distribute their Contributions under a different license, provided it is compatible with this License.</p>"},{"location":"legal/LICENSE/#25-submission-of-contributions","title":"2.5. Submission of Contributions","text":"<p>When You submit a Contribution, You represent that You are legally entitled to grant the rights described.</p>"},{"location":"legal/LICENSE/#26-distribution-of-source-form","title":"2.6. Distribution of Source Form","text":"<p>All distribution of Covered Software in Source Code Form must include a copy of this License and be accompanied by a file documenting the changes made.</p>"},{"location":"legal/LICENSE/#27-distribution-of-executable-form","title":"2.7. Distribution of Executable Form","text":"<p>Executable versions must include a prominent notice stating how to obtain the Source Code Form.</p>"},{"location":"legal/LICENSE/#3-responsibilities","title":"3. Responsibilities","text":""},{"location":"legal/LICENSE/#31-use","title":"3.1. Use","text":"<p>You are responsible for using the Covered Software responsibly and in compliance with all applicable laws.</p>"},{"location":"legal/LICENSE/#32-modifications","title":"3.2. Modifications","text":"<p>Modifications must be documented and preserved in a manner accessible to recipients.</p>"},{"location":"legal/LICENSE/#4-termination","title":"4. Termination","text":"<p>Violation of this License terminates Your rights. However, rights can be reinstated under certain conditions if the violation is cured within 30 days.</p>"},{"location":"legal/LICENSE/#5-disclaimer-of-warranty","title":"5. Disclaimer of Warranty","text":"<p>Covered Software is provided on an \"AS IS\" basis, without warranty of any kind, express or implied.</p>"},{"location":"legal/LICENSE/#6-limitation-of-liability","title":"6. Limitation of Liability","text":"<p>Contributors are not liable for any damages resulting from the use of the Covered Software.</p>"},{"location":"legal/LICENSE/#7-additional-terms","title":"7. Additional Terms","text":"<p>This License does not permit sublicensing. Any additional terms must be included in a separate agreement.</p>"},{"location":"legal/LICENSE/#exhibit-a-incompatible-with-secondary-licenses-notice","title":"Exhibit A - \"Incompatible With Secondary Licenses\" Notice","text":"<p>If You create and distribute Covered Software and you want to prohibit use under certain other licenses, add:</p> <p>\"This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.\"</p> <p>For the full, legally binding version, visit: https://www.mozilla.org/MPL/2.0/</p> <p>\u00a9 2025 Richard Majewski. Licensed under the MPL-2.0.</p>"},{"location":"legal/NOTICE/","title":"NOTICE","text":"<p>This project is licensed under the Mozilla Public License 2.0 (MPL-2.0).</p> <p>\u00a9 2025 Rich Majewski. All rights reserved.</p> <p>This repository contains original work authored by Rich Majewski, including but not limited to:</p> <ul> <li>RUNE framework architecture</li> <li>Runtime Communication, Error, and Registration specifications</li> <li>Plugin execution and orchestration logic</li> <li>Associated documentation, diagrams, and CLI structure</li> </ul> <p>All source code files and documentation within this repository are individually licensed under MPL-2.0, as indicated by the SPDX license identifiers and file headers.</p> <p>This project incorporates no third-party code or dependencies outside what is explicitly listed in <code>pyproject.toml</code> and licensed under compatible terms.</p> <p>Any derivative use of RUNE source or documentation must retain the original license and attribution in all redistributed files.</p> <p>To request a commercial license or alternative terms, please contact the project maintainer directly.</p> <p>For MPL-2.0 license text, see: https://www.mozilla.org/en-US/MPL/2.0/</p>"},{"location":"legal/PATENTS/","title":"PATENTS","text":"<p>As of this publication, no patents have been filed for any part of the RUNE project.</p> <p>The RUNE framework, including its runtime architecture, orchestration design, plugin mediation patterns, and error-handling protocols, is publicly documented and published under an open license (MPL-2.0) as prior art.</p> <p>This constitutes a defensive disclosure to prevent others from patenting the core framework, its communication protocols, or plugin interface contracts.</p> <p>The project author retains all rights to pursue future defensive filings or claim original authorship if patent applications infringe upon this prior art.</p> <p>If this project incorporates third-party packages that are themselves subject to patent grants, those are governed by their respective licenses (see <code>pyproject.toml</code>).</p> <p>This document does not grant any patent licenses beyond those already implied or covered under MPL-2.0.</p> <p>For any questions regarding licensing or intellectual property, contact the project maintainer directly.</p>"}]}